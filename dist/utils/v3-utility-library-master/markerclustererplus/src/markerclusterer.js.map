{"version":3,"sources":["../../../../../src/utils/v3-utility-library-master/markerclustererplus/src/markerclusterer.js"],"names":[],"mappings":";;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;;;;;;;;;;;;AAYA;;;;;;;;;;AAUA,SAAS,WAAT,CAAqB,OAArB,EAA8B,MAA9B,EAAsC;AACpC,UAAQ,kBAAR,GAA6B,MAA7B,CAAoC,WAApC,EAAiD,OAAO,IAAP,CAAY,WAA7D;;AAEA,OAAK,QAAL,GAAgB,OAAhB;AACA,OAAK,UAAL,GAAkB,QAAQ,kBAAR,GAA6B,eAA7B,EAAlB;AACA,OAAK,OAAL,GAAe,MAAf;AACA,OAAK,OAAL,GAAe,IAAf;AACA,OAAK,IAAL,GAAY,IAAZ;AACA,OAAK,KAAL,GAAa,IAAb;AACA,OAAK,QAAL,GAAgB,KAAhB;;AAEA,OAAK,MAAL,CAAY,QAAQ,MAAR,EAAZ,EAXoC,CAWL;AAChC;;AAGD;;;AAGA,YAAY,SAAZ,CAAsB,KAAtB,GAA8B,YAAY;AACxC,MAAI,eAAe,IAAnB;AACA,MAAI,mBAAJ;AACA,MAAI,qBAAJ;;AAEA,OAAK,IAAL,GAAY,SAAS,aAAT,CAAuB,KAAvB,CAAZ;AACA,OAAK,IAAL,CAAU,SAAV,GAAsB,KAAK,UAA3B;AACA,MAAI,KAAK,QAAT,EAAmB;AACjB,SAAK,IAAL;AACD;;AAED,OAAK,QAAL,GAAgB,kBAAhB,CAAmC,WAAnC,CAA+C,KAAK,IAApD;;AAEA;AACA,OAAK,sBAAL,GAA8B,OAAO,IAAP,CAAY,KAAZ,CAAkB,WAAlB,CAA8B,KAAK,MAAL,EAA9B,EAA6C,gBAA7C,EAA+D,YAAY;AACvG,4BAAwB,mBAAxB;AACD,GAF6B,CAA9B;;AAIA,SAAO,IAAP,CAAY,KAAZ,CAAkB,cAAlB,CAAiC,KAAK,IAAtC,EAA4C,WAA5C,EAAyD,YAAY;AACnE,0BAAsB,IAAtB;AACA,4BAAwB,KAAxB;AACD,GAHD;;AAKA,SAAO,IAAP,CAAY,KAAZ,CAAkB,cAAlB,CAAiC,KAAK,IAAtC,EAA4C,OAA5C,EAAqD,UAAU,CAAV,EAAa;AAChE,0BAAsB,KAAtB;AACA,QAAI,CAAC,qBAAL,EAA4B;AAC1B,UAAI,SAAJ;AACA,UAAI,EAAJ;AACA,UAAI,KAAK,aAAa,QAAb,CAAsB,kBAAtB,EAAT;AACA;;;;;;AAMA,aAAO,IAAP,CAAY,KAAZ,CAAkB,OAAlB,CAA0B,EAA1B,EAA8B,OAA9B,EAAuC,aAAa,QAApD;AACA,aAAO,IAAP,CAAY,KAAZ,CAAkB,OAAlB,CAA0B,EAA1B,EAA8B,cAA9B,EAA8C,aAAa,QAA3D,EAX0B,CAW4C;;AAEtE;AACA;AACA,UAAI,GAAG,cAAH,EAAJ,EAAyB;AACvB;AACA,aAAK,GAAG,UAAH,EAAL;AACA,oBAAY,aAAa,QAAb,CAAsB,SAAtB,EAAZ;AACA,WAAG,MAAH,GAAY,SAAZ,CAAsB,SAAtB;AACA;AACA,mBAAW,YAAY;AACrB,aAAG,MAAH,GAAY,SAAZ,CAAsB,SAAtB;AACA;AACA,cAAI,OAAO,IAAP,IAAgB,GAAG,MAAH,GAAY,OAAZ,KAAwB,EAA5C,EAAiD;AAC/C,eAAG,MAAH,GAAY,OAAZ,CAAoB,KAAK,CAAzB;AACD;AACF,SAND,EAMG,GANH;AAOD;;AAED;AACA,QAAE,YAAF,GAAiB,IAAjB;AACA,UAAI,EAAE,eAAN,EAAuB;AACrB,UAAE,eAAF;AACD;AACF;AACF,GAtCD;;AAwCA,SAAO,IAAP,CAAY,KAAZ,CAAkB,cAAlB,CAAiC,KAAK,IAAtC,EAA4C,WAA5C,EAAyD,YAAY;AACnE,QAAI,KAAK,aAAa,QAAb,CAAsB,kBAAtB,EAAT;AACA;;;;;;AAMA,WAAO,IAAP,CAAY,KAAZ,CAAkB,OAAlB,CAA0B,EAA1B,EAA8B,WAA9B,EAA2C,aAAa,QAAxD;AACD,GATD;;AAWA,SAAO,IAAP,CAAY,KAAZ,CAAkB,cAAlB,CAAiC,KAAK,IAAtC,EAA4C,UAA5C,EAAwD,YAAY;AAClE,QAAI,KAAK,aAAa,QAAb,CAAsB,kBAAtB,EAAT;AACA;;;;;;AAMA,WAAO,IAAP,CAAY,KAAZ,CAAkB,OAAlB,CAA0B,EAA1B,EAA8B,UAA9B,EAA0C,aAAa,QAAvD;AACD,GATD;AAUD,CApFD;;AAuFA;;;AAGA,YAAY,SAAZ,CAAsB,QAAtB,GAAiC,YAAY;AAC3C,MAAI,KAAK,IAAL,IAAa,KAAK,IAAL,CAAU,UAA3B,EAAuC;AACrC,SAAK,IAAL;AACA,WAAO,IAAP,CAAY,KAAZ,CAAkB,cAAlB,CAAiC,KAAK,sBAAtC;AACA,WAAO,IAAP,CAAY,KAAZ,CAAkB,sBAAlB,CAAyC,KAAK,IAA9C;AACA,SAAK,IAAL,CAAU,UAAV,CAAqB,WAArB,CAAiC,KAAK,IAAtC;AACA,SAAK,IAAL,GAAY,IAAZ;AACD;AACF,CARD;;AAWA;;;AAGA,YAAY,SAAZ,CAAsB,IAAtB,GAA6B,YAAY;AACvC,MAAI,KAAK,QAAT,EAAmB;AACjB,QAAI,MAAM,KAAK,iBAAL,CAAuB,KAAK,OAA5B,CAAV;AACA,SAAK,IAAL,CAAU,KAAV,CAAgB,GAAhB,GAAsB,IAAI,CAAJ,GAAQ,IAA9B;AACA,SAAK,IAAL,CAAU,KAAV,CAAgB,IAAhB,GAAuB,IAAI,CAAJ,GAAQ,IAA/B;AACD;AACF,CAND;;AASA;;;AAGA,YAAY,SAAZ,CAAsB,IAAtB,GAA6B,YAAY;AACvC,MAAI,KAAK,IAAT,EAAe;AACb,SAAK,IAAL,CAAU,KAAV,CAAgB,OAAhB,GAA0B,MAA1B;AACD;AACD,OAAK,QAAL,GAAgB,KAAhB;AACD,CALD;;AAQA;;;AAGA,YAAY,SAAZ,CAAsB,IAAtB,GAA6B,YAAY;AACvC,MAAI,KAAK,IAAT,EAAe;AACb,QAAI,MAAM,EAAV;AACA;AACA,QAAI,KAAK,KAAK,mBAAL,CAAyB,KAAzB,CAA+B,GAA/B,CAAT;AACA,QAAI,UAAU,SAAS,GAAG,CAAH,EAAM,OAAN,CAAc,YAAd,EAA4B,EAA5B,CAAT,EAA0C,EAA1C,CAAd;AACA,QAAI,UAAU,SAAS,GAAG,CAAH,EAAM,OAAN,CAAc,YAAd,EAA4B,EAA5B,CAAT,EAA0C,EAA1C,CAAd;AACA,QAAI,MAAM,KAAK,iBAAL,CAAuB,KAAK,OAA5B,CAAV;AACA,SAAK,IAAL,CAAU,KAAV,CAAgB,OAAhB,GAA0B,KAAK,SAAL,CAAe,GAAf,CAA1B;AACA,UAAM,eAAe,KAAK,IAApB,GAA2B,oCAA3B,GAAkE,OAAlE,GAA4E,YAA5E,GAA2F,OAA3F,GAAqG,MAA3G;AACA,QAAI,CAAC,KAAK,QAAL,CAAc,kBAAd,GAAmC,kBAAxC,EAA4D;AAC1D,aAAO,gBAAiB,CAAC,CAAD,GAAK,OAAtB,GAAiC,MAAjC,IAA4C,CAAC,CAAD,GAAK,OAAN,GAAiB,KAAK,MAAjE,IAA2E,MAA3E,IACD,CAAC,CAAD,GAAK,OAAN,GAAiB,KAAK,OADpB,IAC+B,MAD/B,GACyC,CAAC,CAAD,GAAK,OAD9C,GACyD,MADhE;AAED;AACD,WAAO,IAAP;AACA,SAAK,IAAL,CAAU,SAAV,GAAsB,MAAM,cAAN,GAClB,qBADkB,GAElB,OAFkB,GAER,KAAK,WAAL,CAAiB,CAAjB,CAFQ,GAEc,KAFd,GAGlB,QAHkB,GAGP,KAAK,WAAL,CAAiB,CAAjB,CAHO,GAGe,KAHf,GAIlB,SAJkB,GAIN,KAAK,UAJC,GAIY,GAJZ,GAKlB,aALkB,GAKF,KAAK,SALH,GAKe,KALf,GAMlB,eANkB,GAMA,KAAK,WANL,GAMmB,GANnB,GAOlB,eAPkB,GAOA,KAAK,WAPL,GAOmB,GAPnB,GAQlB,cARkB,GAQD,KAAK,UARJ,GAQiB,GARjB,GASlB,mBATkB,GASI,KAAK,eATT,GAS2B,GAT3B,GAUlB,qBAVkB,GAWlB,SAXkB,GAWN,KAAK,MAXC,GAWQ,KAXR,GAYlB,cAZkB,GAYD,KAAK,OAZJ,GAYc,KAZd,GAalB,IAbkB,GAaX,KAAK,KAAL,CAAW,IAbA,GAaO,QAb7B;AAcA,QAAI,OAAO,KAAK,KAAL,CAAW,KAAlB,KAA4B,WAA5B,IAA2C,KAAK,KAAL,CAAW,KAAX,KAAqB,EAApE,EAAwE;AACtE,WAAK,IAAL,CAAU,KAAV,GAAkB,KAAK,QAAL,CAAc,kBAAd,GAAmC,QAAnC,EAAlB;AACD,KAFD,MAEO;AACL,WAAK,IAAL,CAAU,KAAV,GAAkB,KAAK,KAAL,CAAW,KAA7B;AACD;AACD,SAAK,IAAL,CAAU,KAAV,CAAgB,OAAhB,GAA0B,EAA1B;AACD;AACD,OAAK,QAAL,GAAgB,IAAhB;AACD,CArCD;;AAwCA;;;;;AAKA,YAAY,SAAZ,CAAsB,QAAtB,GAAiC,UAAU,IAAV,EAAgB;AAC/C,OAAK,KAAL,GAAa,IAAb;AACA,MAAI,QAAQ,KAAK,GAAL,CAAS,CAAT,EAAY,KAAK,KAAL,GAAa,CAAzB,CAAZ;AACA,UAAQ,KAAK,GAAL,CAAS,KAAK,OAAL,CAAa,MAAb,GAAsB,CAA/B,EAAkC,KAAlC,CAAR;AACA,MAAI,QAAQ,KAAK,OAAL,CAAa,KAAb,CAAZ;AACA,OAAK,IAAL,GAAY,MAAM,GAAlB;AACA,OAAK,OAAL,GAAe,MAAM,MAArB;AACA,OAAK,MAAL,GAAc,MAAM,KAApB;AACA,OAAK,WAAL,GAAmB,MAAM,UAAN,IAAoB,CAAC,CAAD,EAAI,CAAJ,CAAvC;AACA,OAAK,WAAL,GAAmB,MAAM,UAAN,IAAoB,CAAC,SAAS,KAAK,OAAL,GAAe,CAAxB,EAA2B,EAA3B,CAAD,EAAiC,SAAS,KAAK,MAAL,GAAc,CAAvB,EAA0B,EAA1B,CAAjC,CAAvC;AACA,OAAK,UAAL,GAAkB,MAAM,SAAN,IAAmB,OAArC;AACA,OAAK,SAAL,GAAiB,MAAM,QAAN,IAAkB,EAAnC;AACA,OAAK,eAAL,GAAuB,MAAM,cAAN,IAAwB,MAA/C;AACA,OAAK,WAAL,GAAmB,MAAM,UAAN,IAAoB,MAAvC;AACA,OAAK,UAAL,GAAkB,MAAM,SAAN,IAAmB,QAArC;AACA,OAAK,WAAL,GAAmB,MAAM,UAAN,IAAoB,kBAAvC;AACA,OAAK,mBAAL,GAA2B,MAAM,kBAAN,IAA4B,KAAvD;AACD,CAjBD;;AAoBA;;;;;AAKA,YAAY,SAAZ,CAAsB,SAAtB,GAAkC,UAAU,MAAV,EAAkB;AAClD,OAAK,OAAL,GAAe,MAAf;AACD,CAFD;;AAKA;;;;;;AAMA,YAAY,SAAZ,CAAsB,SAAtB,GAAkC,UAAU,GAAV,EAAe;AAC/C,MAAI,QAAQ,EAAZ;AACA,QAAM,IAAN,CAAW,kBAAX;AACA,QAAM,IAAN,CAAW,8BAA8B,IAAI,CAAlC,GAAsC,YAAtC,GAAqD,IAAI,CAAzD,GAA6D,KAAxE;AACA,QAAM,IAAN,CAAW,YAAY,KAAK,MAAjB,GAA0B,cAA1B,GAA2C,KAAK,OAAhD,GAA0D,KAArE;AACA,SAAO,MAAM,IAAN,CAAW,EAAX,CAAP;AACD,CAND;;AASA;;;;;;AAMA,YAAY,SAAZ,CAAsB,iBAAtB,GAA0C,UAAU,MAAV,EAAkB;AAC1D,MAAI,MAAM,KAAK,aAAL,GAAqB,oBAArB,CAA0C,MAA1C,CAAV;AACA,MAAI,CAAJ,IAAS,KAAK,WAAL,CAAiB,CAAjB,CAAT;AACA,MAAI,CAAJ,IAAS,KAAK,WAAL,CAAiB,CAAjB,CAAT;AACA,MAAI,CAAJ,GAAQ,SAAS,IAAI,CAAb,EAAgB,EAAhB,CAAR;AACA,MAAI,CAAJ,GAAQ,SAAS,IAAI,CAAb,EAAgB,EAAhB,CAAR;AACA,SAAO,GAAP;AACD,CAPD;;AAUA;;;;;;;AAOA,SAAS,OAAT,CAAiB,EAAjB,EAAqB;AACnB,OAAK,gBAAL,GAAwB,EAAxB;AACA,OAAK,IAAL,GAAY,GAAG,MAAH,EAAZ;AACA,OAAK,SAAL,GAAiB,GAAG,WAAH,EAAjB;AACA,OAAK,eAAL,GAAuB,GAAG,qBAAH,EAAvB;AACA,OAAK,cAAL,GAAsB,GAAG,gBAAH,EAAtB;AACA,OAAK,QAAL,GAAgB,EAAhB;AACA,OAAK,OAAL,GAAe,IAAf;AACA,OAAK,OAAL,GAAe,IAAf;AACA,OAAK,YAAL,GAAoB,IAAI,WAAJ,CAAgB,IAAhB,EAAsB,GAAG,SAAH,EAAtB,CAApB;AACD;;AAGD;;;;;;;AAOA,QAAQ,SAAR,CAAkB,OAAlB,GAA4B,YAAY;AACtC,SAAO,KAAK,QAAL,CAAc,MAArB;AACD,CAFD;;AAKA;;;;;;;AAOA,QAAQ,SAAR,CAAkB,UAAlB,GAA+B,YAAY;AACzC,SAAO,KAAK,QAAZ;AACD,CAFD;;AAKA;;;;;;;AAOA,QAAQ,SAAR,CAAkB,SAAlB,GAA8B,YAAY;AACxC,SAAO,KAAK,OAAZ;AACD,CAFD;;AAKA;;;;;;AAMA,QAAQ,SAAR,CAAkB,MAAlB,GAA2B,YAAY;AACrC,SAAO,KAAK,IAAZ;AACD,CAFD;;AAKA;;;;;;AAMA,QAAQ,SAAR,CAAkB,kBAAlB,GAAuC,YAAY;AACjD,SAAO,KAAK,gBAAZ;AACD,CAFD;;AAKA;;;;;;AAMA,QAAQ,SAAR,CAAkB,SAAlB,GAA8B,YAAY;AACxC,MAAI,CAAJ;AACA,MAAI,SAAS,IAAI,OAAO,IAAP,CAAY,YAAhB,CAA6B,KAAK,OAAlC,EAA2C,KAAK,OAAhD,CAAb;AACA,MAAI,UAAU,KAAK,UAAL,EAAd;AACA,OAAK,IAAI,CAAT,EAAY,IAAI,QAAQ,MAAxB,EAAgC,GAAhC,EAAqC;AACnC,WAAO,MAAP,CAAc,QAAQ,CAAR,EAAW,WAAX,EAAd;AACD;AACD,SAAO,MAAP;AACD,CARD;;AAWA;;;;;AAKA,QAAQ,SAAR,CAAkB,MAAlB,GAA2B,YAAY;AACrC,OAAK,YAAL,CAAkB,MAAlB,CAAyB,IAAzB;AACA,OAAK,QAAL,GAAgB,EAAhB;AACA,SAAO,KAAK,QAAZ;AACD,CAJD;;AAOA;;;;;;;AAOA,QAAQ,SAAR,CAAkB,SAAlB,GAA8B,UAAU,MAAV,EAAkB;AAC9C,MAAI,CAAJ;AACA,MAAI,MAAJ;AACA,MAAI,EAAJ;;AAEA,MAAI,KAAK,qBAAL,CAA2B,MAA3B,CAAJ,EAAwC;AACtC,WAAO,KAAP;AACD;;AAED,MAAI,CAAC,KAAK,OAAV,EAAmB;AACjB,SAAK,OAAL,GAAe,OAAO,WAAP,EAAf;AACA,SAAK,gBAAL;AACD,GAHD,MAGO;AACL,QAAI,KAAK,cAAT,EAAyB;AACvB,UAAI,IAAI,KAAK,QAAL,CAAc,MAAd,GAAuB,CAA/B;AACA,UAAI,MAAM,CAAC,KAAK,OAAL,CAAa,GAAb,MAAsB,IAAI,CAA1B,IAA+B,OAAO,WAAP,GAAqB,GAArB,EAAhC,IAA8D,CAAxE;AACA,UAAI,MAAM,CAAC,KAAK,OAAL,CAAa,GAAb,MAAsB,IAAI,CAA1B,IAA+B,OAAO,WAAP,GAAqB,GAArB,EAAhC,IAA8D,CAAxE;AACA,WAAK,OAAL,GAAe,IAAI,OAAO,IAAP,CAAY,MAAhB,CAAuB,GAAvB,EAA4B,GAA5B,CAAf;AACA,WAAK,gBAAL;AACD;AACF;;AAED,SAAO,OAAP,GAAiB,IAAjB;AACA,OAAK,QAAL,CAAc,IAAd,CAAmB,MAAnB;;AAEA,WAAS,KAAK,QAAL,CAAc,MAAvB;AACA,OAAK,KAAK,gBAAL,CAAsB,UAAtB,EAAL;AACA,MAAI,OAAO,IAAP,IAAe,KAAK,IAAL,CAAU,OAAV,KAAsB,EAAzC,EAA6C;AAC3C;AACA,QAAI,OAAO,MAAP,OAAoB,KAAK,IAA7B,EAAmC;AACjC,aAAO,MAAP,CAAc,KAAK,IAAnB;AACD;AACF,GALD,MAKO,IAAI,SAAS,KAAK,eAAlB,EAAmC;AACxC;AACA,QAAI,OAAO,MAAP,OAAoB,KAAK,IAA7B,EAAmC;AACjC,aAAO,MAAP,CAAc,KAAK,IAAnB;AACD;AACF,GALM,MAKA,IAAI,WAAW,KAAK,eAApB,EAAqC;AAC1C;AACA,SAAK,IAAI,CAAT,EAAY,IAAI,MAAhB,EAAwB,GAAxB,EAA6B;AAC3B,WAAK,QAAL,CAAc,CAAd,EAAiB,MAAjB,CAAwB,IAAxB;AACD;AACF,GALM,MAKA;AACL,WAAO,MAAP,CAAc,IAAd;AACD;;AAED,OAAK,WAAL;AACA,SAAO,IAAP;AACD,CAhDD;;AAmDA;;;;;;;AAOA,QAAQ,SAAR,CAAkB,uBAAlB,GAA4C,UAAU,MAAV,EAAkB;AAC5D,SAAO,KAAK,OAAL,CAAa,QAAb,CAAsB,OAAO,WAAP,EAAtB,CAAP;AACD,CAFD;;AAKA;;;AAGA,QAAQ,SAAR,CAAkB,gBAAlB,GAAqC,YAAY;AAC/C,MAAI,SAAS,IAAI,OAAO,IAAP,CAAY,YAAhB,CAA6B,KAAK,OAAlC,EAA2C,KAAK,OAAhD,CAAb;AACA,OAAK,OAAL,GAAe,KAAK,gBAAL,CAAsB,iBAAtB,CAAwC,MAAxC,CAAf;AACD,CAHD;;AAMA;;;AAGA,QAAQ,SAAR,CAAkB,WAAlB,GAAgC,YAAY;AAC1C,MAAI,SAAS,KAAK,QAAL,CAAc,MAA3B;AACA,MAAI,KAAK,KAAK,gBAAL,CAAsB,UAAtB,EAAT;;AAEA,MAAI,OAAO,IAAP,IAAe,KAAK,IAAL,CAAU,OAAV,KAAsB,EAAzC,EAA6C;AAC3C,SAAK,YAAL,CAAkB,IAAlB;AACA;AACD;;AAED,MAAI,SAAS,KAAK,eAAlB,EAAmC;AACjC;AACA,SAAK,YAAL,CAAkB,IAAlB;AACA;AACD;;AAED,MAAI,YAAY,KAAK,gBAAL,CAAsB,SAAtB,GAAkC,MAAlD;AACA,MAAI,OAAO,KAAK,gBAAL,CAAsB,aAAtB,GAAsC,KAAK,QAA3C,EAAqD,SAArD,CAAX;AACA,OAAK,YAAL,CAAkB,SAAlB,CAA4B,KAAK,OAAjC;AACA,OAAK,YAAL,CAAkB,QAAlB,CAA2B,IAA3B;AACA,OAAK,YAAL,CAAkB,IAAlB;AACD,CApBD;;AAuBA;;;;;;AAMA,QAAQ,SAAR,CAAkB,qBAAlB,GAA0C,UAAU,MAAV,EAAkB;AAC1D,MAAI,CAAJ;AACA,MAAI,KAAK,QAAL,CAAc,OAAlB,EAA2B;AACzB,WAAO,KAAK,QAAL,CAAc,OAAd,CAAsB,MAAtB,MAAkC,CAAC,CAA1C;AACD,GAFD,MAEO;AACL,SAAK,IAAI,CAAT,EAAY,IAAI,KAAK,QAAL,CAAc,MAA9B,EAAsC,GAAtC,EAA2C;AACzC,UAAI,WAAW,KAAK,QAAL,CAAc,CAAd,CAAf,EAAiC;AAC/B,eAAO,IAAP;AACD;AACF;AACF;AACD,SAAO,KAAP;AACD,CAZD;;AAeA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0EA;;;;;;;;AAQA,SAAS,eAAT,CAAyB,GAAzB,EAA8B,WAA9B,EAA2C,WAA3C,EAAwD;AACtD;AACA;AACA;AACA;AACA;AACA,OAAK,MAAL,CAAY,eAAZ,EAA6B,OAAO,IAAP,CAAY,WAAzC;;AAEA,gBAAc,eAAe,EAA7B;AACA,gBAAc,eAAe,EAA7B;;AAEA,OAAK,QAAL,GAAgB,EAAhB;AACA,OAAK,SAAL,GAAiB,EAAjB;AACA,OAAK,UAAL,GAAkB,EAAlB;AACA,OAAK,UAAL,GAAkB,IAAlB;AACA,OAAK,MAAL,GAAc,KAAd;;AAEA,OAAK,SAAL,GAAiB,YAAY,QAAZ,IAAwB,EAAzC;AACA,OAAK,eAAL,GAAuB,YAAY,kBAAZ,IAAkC,CAAzD;AACA,OAAK,QAAL,GAAgB,YAAY,OAAZ,IAAuB,IAAvC;AACA,OAAK,OAAL,GAAe,YAAY,MAAZ,IAAsB,EAArC;AACA,OAAK,MAAL,GAAc,YAAY,KAAZ,IAAqB,EAAnC;AACA,OAAK,YAAL,GAAoB,IAApB;AACA,MAAI,YAAY,WAAZ,KAA4B,SAAhC,EAA2C;AACzC,SAAK,YAAL,GAAoB,YAAY,WAAhC;AACD;AACD,OAAK,cAAL,GAAsB,KAAtB;AACA,MAAI,YAAY,aAAZ,KAA8B,SAAlC,EAA6C;AAC3C,SAAK,cAAL,GAAsB,YAAY,aAAlC;AACD;AACD,OAAK,aAAL,GAAqB,KAArB;AACA,MAAI,YAAY,YAAZ,KAA6B,SAAjC,EAA4C;AAC1C,SAAK,aAAL,GAAqB,YAAY,YAAjC;AACD;AACD,OAAK,kBAAL,GAA0B,KAA1B;AACA,MAAI,YAAY,iBAAZ,KAAkC,SAAtC,EAAiD;AAC/C,SAAK,kBAAL,GAA0B,YAAY,iBAAtC;AACD;AACD,OAAK,UAAL,GAAkB,YAAY,SAAZ,IAAyB,gBAAgB,UAA3D;AACA,OAAK,eAAL,GAAuB,YAAY,cAAZ,IAA8B,gBAAgB,eAArE;AACA,OAAK,WAAL,GAAmB,YAAY,UAAZ,IAA0B,gBAAgB,WAA7D;AACA,OAAK,WAAL,GAAmB,YAAY,UAAZ,IAA0B,gBAAgB,UAA7D;AACA,OAAK,UAAL,GAAkB,YAAY,SAAZ,IAAyB,gBAAgB,UAA3D;AACA,OAAK,YAAL,GAAoB,YAAY,WAAZ,IAA2B,gBAAgB,aAA/D;AACA,OAAK,aAAL,GAAqB,YAAY,YAAZ,IAA4B,SAAjD;;AAEA,MAAI,UAAU,SAAV,CAAoB,WAApB,GAAkC,OAAlC,CAA0C,MAA1C,MAAsD,CAAC,CAA3D,EAA8D;AAC5D;AACA,SAAK,UAAL,GAAkB,KAAK,YAAvB;AACD;;AAED,OAAK,YAAL;;AAEA,OAAK,UAAL,CAAgB,WAAhB,EAA6B,IAA7B;AACA,OAAK,MAAL,CAAY,GAAZ,EAtDsD,CAsDpC;AACnB;;AAGD;;;;AAIA,gBAAgB,SAAhB,CAA0B,KAA1B,GAAkC,YAAY;AAC5C,MAAI,mBAAmB,IAAvB;;AAEA,OAAK,UAAL,GAAkB,KAAK,MAAL,EAAlB;AACA,OAAK,MAAL,GAAc,IAAd;;AAEA,OAAK,OAAL;;AAEA;AACA,OAAK,UAAL,GAAkB,CAChB,OAAO,IAAP,CAAY,KAAZ,CAAkB,WAAlB,CAA8B,KAAK,MAAL,EAA9B,EAA6C,cAA7C,EAA6D,YAAY;AACvE,qBAAiB,cAAjB,CAAgC,KAAhC;AACA;AACA;AACA;AACA;AACA;AACA,QAAI,KAAK,OAAL,QAAoB,KAAK,GAAL,CAAS,SAAT,KAAuB,CAA3C,KAAiD,KAAK,OAAL,OAAmB,KAAK,GAAL,CAAS,SAAT,CAAxE,EAA6F;AAC3F,aAAO,IAAP,CAAY,KAAZ,CAAkB,OAAlB,CAA0B,IAA1B,EAAgC,MAAhC;AACD;AACF,GAVD,CADgB,EAYhB,OAAO,IAAP,CAAY,KAAZ,CAAkB,WAAlB,CAA8B,KAAK,MAAL,EAA9B,EAA6C,MAA7C,EAAqD,YAAY;AAC/D,qBAAiB,OAAjB;AACD,GAFD,CAZgB,CAAlB;AAgBD,CAzBD;;AA4BA;;;;;;AAMA,gBAAgB,SAAhB,CAA0B,QAA1B,GAAqC,YAAY;AAC/C,MAAI,CAAJ;;AAEA;AACA,OAAK,IAAI,CAAT,EAAY,IAAI,KAAK,QAAL,CAAc,MAA9B,EAAsC,GAAtC,EAA2C;AACzC,QAAI,KAAK,QAAL,CAAc,CAAd,EAAiB,MAAjB,OAA8B,KAAK,UAAvC,EAAmD;AACjD,WAAK,QAAL,CAAc,CAAd,EAAiB,MAAjB,CAAwB,KAAK,UAA7B;AACD;AACF;;AAED;AACA,OAAK,IAAI,CAAT,EAAY,IAAI,KAAK,SAAL,CAAe,MAA/B,EAAuC,GAAvC,EAA4C;AAC1C,SAAK,SAAL,CAAe,CAAf,EAAkB,MAAlB;AACD;AACD,OAAK,SAAL,GAAiB,EAAjB;;AAEA;AACA,OAAK,IAAI,CAAT,EAAY,IAAI,KAAK,UAAL,CAAgB,MAAhC,EAAwC,GAAxC,EAA6C;AAC3C,WAAO,IAAP,CAAY,KAAZ,CAAkB,cAAlB,CAAiC,KAAK,UAAL,CAAgB,CAAhB,CAAjC;AACD;AACD,OAAK,UAAL,GAAkB,EAAlB;;AAEA,OAAK,UAAL,GAAkB,IAAlB;AACA,OAAK,MAAL,GAAc,KAAd;AACD,CAxBD;;AA2BA;;;;AAIA,gBAAgB,SAAhB,CAA0B,IAA1B,GAAiC,YAAY,CAAE,CAA/C;;AAGA;;;AAGA,gBAAgB,SAAhB,CAA0B,YAA1B,GAAyC,YAAY;AACnD,MAAI,CAAJ,EAAO,IAAP;AACA,MAAI,KAAK,OAAL,CAAa,MAAb,GAAsB,CAA1B,EAA6B;AAC3B;AACD;;AAED,OAAK,IAAI,CAAT,EAAY,IAAI,KAAK,WAAL,CAAiB,MAAjC,EAAyC,GAAzC,EAA8C;AAC5C,WAAO,KAAK,WAAL,CAAiB,CAAjB,CAAP;AACA,SAAK,OAAL,CAAa,IAAb,CAAkB;AAChB,WAAK,KAAK,UAAL,IAAmB,IAAI,CAAvB,IAA4B,GAA5B,GAAkC,KAAK,eAD5B;AAEhB,cAAQ,IAFQ;AAGhB,aAAO;AAHS,KAAlB;AAKD;AACF,CAdD;;AAiBA;;;AAGA,gBAAgB,SAAhB,CAA0B,eAA1B,GAA4C,YAAY;AACtD,MAAI,CAAJ;AACA,MAAI,UAAU,KAAK,UAAL,EAAd;AACA,MAAI,SAAS,IAAI,OAAO,IAAP,CAAY,YAAhB,EAAb;AACA,OAAK,IAAI,CAAT,EAAY,IAAI,QAAQ,MAAxB,EAAgC,GAAhC,EAAqC;AACnC,WAAO,MAAP,CAAc,QAAQ,CAAR,EAAW,WAAX,EAAd;AACD;;AAED,OAAK,MAAL,GAAc,SAAd,CAAwB,MAAxB;AACD,CATD;;AAYA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,WAA1B,GAAwC,YAAY;AAClD,SAAO,KAAK,SAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,WAA1B,GAAwC,UAAU,QAAV,EAAoB;AAC1D,OAAK,SAAL,GAAiB,QAAjB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,qBAA1B,GAAkD,YAAY;AAC5D,SAAO,KAAK,eAAZ;AACD,CAFD;;AAIA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,qBAA1B,GAAkD,UAAU,kBAAV,EAA8B;AAC9E,OAAK,eAAL,GAAuB,kBAAvB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,UAA1B,GAAuC,YAAY;AACjD,SAAO,KAAK,QAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,UAA1B,GAAuC,UAAU,OAAV,EAAmB;AACxD,OAAK,QAAL,GAAgB,OAAhB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,SAA1B,GAAsC,YAAY;AAChD,SAAO,KAAK,OAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,SAA1B,GAAsC,UAAU,MAAV,EAAkB;AACtD,OAAK,OAAL,GAAe,MAAf;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,QAA1B,GAAqC,YAAY;AAC/C,SAAO,KAAK,MAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,QAA1B,GAAqC,UAAU,KAAV,EAAiB;AACpD,OAAK,MAAL,GAAc,KAAd;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,cAA1B,GAA2C,YAAY;AACrD,SAAO,KAAK,YAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,cAA1B,GAA2C,UAAU,WAAV,EAAuB;AAChE,OAAK,YAAL,GAAoB,WAApB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,gBAA1B,GAA6C,YAAY;AACvD,SAAO,KAAK,cAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,gBAA1B,GAA6C,UAAU,aAAV,EAAyB;AACpE,OAAK,cAAL,GAAsB,aAAtB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,eAA1B,GAA4C,YAAY;AACtD,SAAO,KAAK,aAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,eAA1B,GAA4C,UAAU,YAAV,EAAwB;AAClE,OAAK,aAAL,GAAqB,YAArB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,oBAA1B,GAAiD,YAAY;AAC3D,SAAO,KAAK,kBAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,oBAA1B,GAAiD,UAAU,iBAAV,EAA6B;AAC5E,OAAK,kBAAL,GAA0B,iBAA1B;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,iBAA1B,GAA8C,YAAY;AACxD,SAAO,KAAK,eAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,iBAA1B,GAA8C,UAAU,cAAV,EAA0B;AACtE,OAAK,eAAL,GAAuB,cAAvB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,YAA1B,GAAyC,YAAY;AACnD,SAAO,KAAK,UAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,YAA1B,GAAyC,UAAU,SAAV,EAAqB;AAC5D,OAAK,UAAL,GAAkB,SAAlB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,aAA1B,GAA0C,YAAY;AACpD,SAAO,KAAK,WAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,aAA1B,GAA0C,UAAU,UAAV,EAAsB;AAC9D,OAAK,WAAL,GAAmB,UAAnB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,aAA1B,GAA0C,YAAY;AACpD,SAAO,KAAK,WAAZ;AACD,CAFD;;AAKA;;;;;;AAMA,gBAAgB,SAAhB,CAA0B,aAA1B,GAA0C,UAAU,UAAV,EAAsB;AAC9D,OAAK,WAAL,GAAmB,UAAnB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,cAA1B,GAA2C,YAAY;AACrD,SAAO,KAAK,YAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,cAA1B,GAA2C,UAAU,WAAV,EAAuB;AAChE,OAAK,YAAL,GAAoB,WAApB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,eAA1B,GAA4C,YAAY;AACtD,SAAO,KAAK,aAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,eAA1B,GAA4C,UAAU,YAAV,EAAwB;AAClE,OAAK,aAAL,GAAqB,YAArB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,UAA1B,GAAuC,YAAY;AACjD,SAAO,KAAK,QAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,eAA1B,GAA4C,YAAY;AACtD,SAAO,KAAK,QAAL,CAAc,MAArB;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,WAA1B,GAAwC,YAAY;AAClD,SAAO,KAAK,SAAZ;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,gBAA1B,GAA6C,YAAY;AACvD,SAAO,KAAK,SAAL,CAAe,MAAtB;AACD,CAFD;;AAKA;;;;;;;AAOA,gBAAgB,SAAhB,CAA0B,SAA1B,GAAsC,UAAU,MAAV,EAAkB,UAAlB,EAA8B;AAClE,OAAK,aAAL,CAAmB,MAAnB;AACA,MAAI,CAAC,UAAL,EAAiB;AACf,SAAK,OAAL;AACD;AACF,CALD;;AAQA;;;;;;;AAOA,gBAAgB,SAAhB,CAA0B,UAA1B,GAAuC,UAAU,OAAV,EAAmB,UAAnB,EAA+B;AACpE,MAAI,GAAJ;AACA,OAAK,GAAL,IAAY,OAAZ,EAAqB;AACnB,QAAI,QAAQ,cAAR,CAAuB,GAAvB,CAAJ,EAAiC;AAC/B,WAAK,aAAL,CAAmB,QAAQ,GAAR,CAAnB;AACD;AACF;AACD,MAAI,CAAC,UAAL,EAAiB;AACf,SAAK,OAAL;AACD;AACF,CAVD;;AAaA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,aAA1B,GAA0C,UAAU,MAAV,EAAkB;AAC1D;AACA,MAAI,OAAO,YAAP,EAAJ,EAA2B;AACzB,QAAI,mBAAmB,IAAvB;AACA,WAAO,IAAP,CAAY,KAAZ,CAAkB,WAAlB,CAA8B,MAA9B,EAAsC,SAAtC,EAAiD,YAAY;AAC3D,UAAI,iBAAiB,MAArB,EAA6B;AAC3B,aAAK,OAAL,GAAe,KAAf;AACA,yBAAiB,OAAjB;AACD;AACF,KALD;AAMD;AACD,SAAO,OAAP,GAAiB,KAAjB;AACA,OAAK,QAAL,CAAc,IAAd,CAAmB,MAAnB;AACD,CAbD;;AAgBA;;;;;;;;;AASA,gBAAgB,SAAhB,CAA0B,YAA1B,GAAyC,UAAU,MAAV,EAAkB,UAAlB,EAA8B;AACrE,MAAI,UAAU,KAAK,aAAL,CAAmB,MAAnB,CAAd;;AAEA,MAAI,CAAC,UAAD,IAAe,OAAnB,EAA4B;AAC1B,SAAK,OAAL;AACD;;AAED,SAAO,OAAP;AACD,CARD;;AAWA;;;;;;;;;AASA,gBAAgB,SAAhB,CAA0B,aAA1B,GAA0C,UAAU,OAAV,EAAmB,UAAnB,EAA+B;AACvE,MAAI,CAAJ,EAAO,CAAP;AACA,MAAI,UAAU,KAAd;;AAEA,OAAK,IAAI,CAAT,EAAY,IAAI,QAAQ,MAAxB,EAAgC,GAAhC,EAAqC;AACnC,QAAI,KAAK,aAAL,CAAmB,QAAQ,CAAR,CAAnB,CAAJ;AACA,cAAU,WAAW,CAArB;AACD;;AAED,MAAI,CAAC,UAAD,IAAe,OAAnB,EAA4B;AAC1B,SAAK,OAAL;AACD;;AAED,SAAO,OAAP;AACD,CAdD;;AAiBA;;;;;;AAMA,gBAAgB,SAAhB,CAA0B,aAA1B,GAA0C,UAAU,MAAV,EAAkB;AAC1D,MAAI,CAAJ;AACA,MAAI,QAAQ,CAAC,CAAb;AACA,MAAI,KAAK,QAAL,CAAc,OAAlB,EAA2B;AACzB,YAAQ,KAAK,QAAL,CAAc,OAAd,CAAsB,MAAtB,CAAR;AACD,GAFD,MAEO;AACL,SAAK,IAAI,CAAT,EAAY,IAAI,KAAK,QAAL,CAAc,MAA9B,EAAsC,GAAtC,EAA2C;AACzC,UAAI,WAAW,KAAK,QAAL,CAAc,CAAd,CAAf,EAAiC;AAC/B,gBAAQ,CAAR;AACA;AACD;AACF;AACF;;AAED,MAAI,UAAU,CAAC,CAAf,EAAkB;AAChB;AACA,WAAO,KAAP;AACD;;AAED,SAAO,MAAP,CAAc,IAAd;AACA,OAAK,QAAL,CAAc,MAAd,CAAqB,KAArB,EAA4B,CAA5B,EApB0D,CAoB1B;AAChC,SAAO,IAAP;AACD,CAtBD;;AAyBA;;;;AAIA,gBAAgB,SAAhB,CAA0B,YAA1B,GAAyC,YAAY;AACnD,OAAK,cAAL,CAAoB,IAApB;AACA,OAAK,QAAL,GAAgB,EAAhB;AACD,CAHD;;AAMA;;;;AAIA,gBAAgB,SAAhB,CAA0B,OAA1B,GAAoC,YAAY;AAC9C,MAAI,cAAc,KAAK,SAAL,CAAe,KAAf,EAAlB;AACA,OAAK,SAAL,GAAiB,EAAjB;AACA,OAAK,cAAL,CAAoB,KAApB;AACA,OAAK,OAAL;;AAEA;AACA;AACA,aAAW,YAAY;AACrB,QAAI,CAAJ;AACA,SAAK,IAAI,CAAT,EAAY,IAAI,YAAY,MAA5B,EAAoC,GAApC,EAAyC;AACvC,kBAAY,CAAZ,EAAe,MAAf;AACD;AACF,GALD,EAKG,CALH;AAMD,CAdD;;AAiBA;;;;;;;AAOA,gBAAgB,SAAhB,CAA0B,iBAA1B,GAA8C,UAAU,MAAV,EAAkB;AAC9D,MAAI,aAAa,KAAK,aAAL,EAAjB;;AAEA;AACA,MAAI,KAAK,IAAI,OAAO,IAAP,CAAY,MAAhB,CAAuB,OAAO,YAAP,GAAsB,GAAtB,EAAvB,EACL,OAAO,YAAP,GAAsB,GAAtB,EADK,CAAT;AAEA,MAAI,KAAK,IAAI,OAAO,IAAP,CAAY,MAAhB,CAAuB,OAAO,YAAP,GAAsB,GAAtB,EAAvB,EACL,OAAO,YAAP,GAAsB,GAAtB,EADK,CAAT;;AAGA;AACA,MAAI,QAAQ,WAAW,oBAAX,CAAgC,EAAhC,CAAZ;AACA,QAAM,CAAN,IAAW,KAAK,SAAhB;AACA,QAAM,CAAN,IAAW,KAAK,SAAhB;;AAEA,MAAI,QAAQ,WAAW,oBAAX,CAAgC,EAAhC,CAAZ;AACA,QAAM,CAAN,IAAW,KAAK,SAAhB;AACA,QAAM,CAAN,IAAW,KAAK,SAAhB;;AAEA;AACA,MAAI,KAAK,WAAW,oBAAX,CAAgC,KAAhC,CAAT;AACA,MAAI,KAAK,WAAW,oBAAX,CAAgC,KAAhC,CAAT;;AAEA;AACA,SAAO,MAAP,CAAc,EAAd;AACA,SAAO,MAAP,CAAc,EAAd;;AAEA,SAAO,MAAP;AACD,CA3BD;;AA8BA;;;AAGA,gBAAgB,SAAhB,CAA0B,OAA1B,GAAoC,YAAY;AAC9C,OAAK,eAAL,CAAqB,CAArB;AACD,CAFD;;AAKA;;;;;;;AAOA,gBAAgB,SAAhB,CAA0B,cAA1B,GAA2C,UAAU,QAAV,EAAoB;AAC7D,MAAI,CAAJ,EAAO,MAAP;AACA;AACA,OAAK,IAAI,CAAT,EAAY,IAAI,KAAK,SAAL,CAAe,MAA/B,EAAuC,GAAvC,EAA4C;AAC1C,SAAK,SAAL,CAAe,CAAf,EAAkB,MAAlB;AACD;AACD,OAAK,SAAL,GAAiB,EAAjB;;AAEA;AACA,OAAK,IAAI,CAAT,EAAY,IAAI,KAAK,QAAL,CAAc,MAA9B,EAAsC,GAAtC,EAA2C;AACzC,aAAS,KAAK,QAAL,CAAc,CAAd,CAAT;AACA,WAAO,OAAP,GAAiB,KAAjB;AACA,QAAI,QAAJ,EAAc;AACZ,aAAO,MAAP,CAAc,IAAd;AACD;AACF;AACF,CAhBD;;AAmBA;;;;;;;;AAQA,gBAAgB,SAAhB,CAA0B,sBAA1B,GAAmD,UAAU,EAAV,EAAc,EAAd,EAAkB;AACnE,MAAI,IAAI,IAAR,CADmE,CACrD;AACd,MAAI,OAAO,CAAC,GAAG,GAAH,KAAW,GAAG,GAAH,EAAZ,IAAwB,KAAK,EAA7B,GAAkC,GAA7C;AACA,MAAI,OAAO,CAAC,GAAG,GAAH,KAAW,GAAG,GAAH,EAAZ,IAAwB,KAAK,EAA7B,GAAkC,GAA7C;AACA,MAAI,IAAI,KAAK,GAAL,CAAS,OAAO,CAAhB,IAAqB,KAAK,GAAL,CAAS,OAAO,CAAhB,CAArB,GACN,KAAK,GAAL,CAAS,GAAG,GAAH,KAAW,KAAK,EAAhB,GAAqB,GAA9B,IAAqC,KAAK,GAAL,CAAS,GAAG,GAAH,KAAW,KAAK,EAAhB,GAAqB,GAA9B,CAArC,GACA,KAAK,GAAL,CAAS,OAAO,CAAhB,CADA,GACqB,KAAK,GAAL,CAAS,OAAO,CAAhB,CAFvB;AAGA,MAAI,IAAI,IAAI,KAAK,KAAL,CAAW,KAAK,IAAL,CAAU,CAAV,CAAX,EAAyB,KAAK,IAAL,CAAU,IAAI,CAAd,CAAzB,CAAZ;AACA,MAAI,IAAI,IAAI,CAAZ;AACA,SAAO,CAAP;AACD,CAVD;;AAaA;;;;;;;AAOA,gBAAgB,SAAhB,CAA0B,iBAA1B,GAA8C,UAAU,MAAV,EAAkB,MAAlB,EAA0B;AACtE,SAAO,OAAO,QAAP,CAAgB,OAAO,WAAP,EAAhB,CAAP;AACD,CAFD;;AAKA;;;;;AAKA,gBAAgB,SAAhB,CAA0B,oBAA1B,GAAiD,UAAU,MAAV,EAAkB;AACjE,MAAI,CAAJ,EAAO,CAAP,EAAU,OAAV,EAAmB,MAAnB;AACA,MAAI,WAAW,KAAf,CAFiE,CAE3C;AACtB,MAAI,iBAAiB,IAArB;AACA,OAAK,IAAI,CAAT,EAAY,IAAI,KAAK,SAAL,CAAe,MAA/B,EAAuC,GAAvC,EAA4C;AAC1C,cAAU,KAAK,SAAL,CAAe,CAAf,CAAV;AACA,aAAS,QAAQ,SAAR,EAAT;AACA,QAAI,MAAJ,EAAY;AACV,UAAI,KAAK,sBAAL,CAA4B,MAA5B,EAAoC,OAAO,WAAP,EAApC,CAAJ;AACA,UAAI,IAAI,QAAR,EAAkB;AAChB,mBAAW,CAAX;AACA,yBAAiB,OAAjB;AACD;AACF;AACF;;AAED,MAAI,kBAAkB,eAAe,uBAAf,CAAuC,MAAvC,CAAtB,EAAsE;AACpE,mBAAe,SAAf,CAAyB,MAAzB;AACD,GAFD,MAEO;AACL,cAAU,IAAI,OAAJ,CAAY,IAAZ,CAAV;AACA,YAAQ,SAAR,CAAkB,MAAlB;AACA,SAAK,SAAL,CAAe,IAAf,CAAoB,OAApB;AACD;AACF,CAvBD;;AA0BA;;;;;;;AAOA,gBAAgB,SAAhB,CAA0B,eAA1B,GAA4C,UAAU,MAAV,EAAkB;AAC5D,MAAI,CAAJ,EAAO,MAAP;AACA,MAAI,SAAJ;AACA,MAAI,mBAAmB,IAAvB;AACA,MAAI,CAAC,KAAK,MAAV,EAAkB;AAChB;AACD;;AAED;AACA,MAAI,WAAW,CAAf,EAAkB;AAChB;;;;;;;AAOA,WAAO,IAAP,CAAY,KAAZ,CAAkB,OAAlB,CAA0B,IAA1B,EAAgC,iBAAhC,EAAmD,IAAnD;;AAEA,QAAI,OAAO,KAAK,cAAZ,KAA+B,WAAnC,EAAgD;AAC9C,mBAAa,KAAK,cAAlB;AACA,aAAO,KAAK,cAAZ;AACD;AACF;;AAED;AACA;AACA;AACA;AACA,MAAI,KAAK,MAAL,GAAc,OAAd,KAA0B,CAA9B,EAAiC;AAC/B,gBAAY,IAAI,OAAO,IAAP,CAAY,YAAhB,CAA6B,KAAK,MAAL,GAAc,SAAd,GAA0B,YAA1B,EAA7B,EACV,KAAK,MAAL,GAAc,SAAd,GAA0B,YAA1B,EADU,CAAZ;AAED,GAHD,MAGO;AACL,gBAAY,IAAI,OAAO,IAAP,CAAY,YAAhB,CAA6B,IAAI,OAAO,IAAP,CAAY,MAAhB,CAAuB,iBAAvB,EAA0C,CAAC,eAA3C,CAA7B,EAA0F,IAAI,OAAO,IAAP,CAAY,MAAhB,CAAuB,CAAC,iBAAxB,EAA2C,eAA3C,CAA1F,CAAZ;AACD;AACD,MAAI,SAAS,KAAK,iBAAL,CAAuB,SAAvB,CAAb;;AAEA,MAAI,QAAQ,KAAK,GAAL,CAAS,SAAS,KAAK,UAAvB,EAAmC,KAAK,QAAL,CAAc,MAAjD,CAAZ;;AAEA,OAAK,IAAI,MAAT,EAAiB,IAAI,KAArB,EAA4B,GAA5B,EAAiC;AAC/B,aAAS,KAAK,QAAL,CAAc,CAAd,CAAT;AACA,QAAI,CAAC,OAAO,OAAR,IAAmB,KAAK,iBAAL,CAAuB,MAAvB,EAA+B,MAA/B,CAAvB,EAA+D;AAC7D,UAAI,CAAC,KAAK,aAAN,IAAwB,KAAK,aAAL,IAAsB,OAAO,UAAP,EAAlD,EAAwE;AACtE,aAAK,oBAAL,CAA0B,MAA1B;AACD;AACF;AACF;;AAED,MAAI,QAAQ,KAAK,QAAL,CAAc,MAA1B,EAAkC;AAChC,SAAK,cAAL,GAAsB,WAAW,YAAY;AAC3C,uBAAiB,eAAjB,CAAiC,KAAjC;AACD,KAFqB,EAEnB,CAFmB,CAAtB;AAGD,GAJD,MAIO;AACL,WAAO,KAAK,cAAZ;;AAEA;;;;;;;AAOA,WAAO,IAAP,CAAY,KAAZ,CAAkB,OAAlB,CAA0B,IAA1B,EAAgC,eAAhC,EAAiD,IAAjD;AACD;AACF,CAhED;;AAmEA;;;;;;;;AAQA,gBAAgB,SAAhB,CAA0B,MAA1B,GAAmC,UAAU,IAAV,EAAgB,IAAhB,EAAsB;AACvD,SAAQ,UAAU,MAAV,EAAkB;AACxB,QAAI,QAAJ;AACA,SAAK,QAAL,IAAiB,OAAO,SAAxB,EAAmC;AACjC,WAAK,SAAL,CAAe,QAAf,IAA2B,OAAO,SAAP,CAAiB,QAAjB,CAA3B;AACD;AACD,WAAO,IAAP;AACD,GANM,CAMJ,KANI,CAME,IANF,EAMQ,CAAC,IAAD,CANR,CAAP;AAOD,CARD;;AAWA;;;;;;;;;;AAUA,gBAAgB,UAAhB,GAA6B,UAAU,OAAV,EAAmB,SAAnB,EAA8B;AACzD,MAAI,QAAQ,CAAZ;AACA,MAAI,QAAQ,EAAZ;AACA,MAAI,QAAQ,QAAQ,MAAR,CAAe,QAAf,EAAZ;;AAEA,MAAI,KAAK,KAAT;AACA,SAAO,OAAO,CAAd,EAAiB;AACf,SAAK,SAAS,KAAK,EAAd,EAAkB,EAAlB,CAAL;AACA;AACD;;AAED,UAAQ,KAAK,GAAL,CAAS,KAAT,EAAgB,SAAhB,CAAR;AACA,SAAO;AACL,UAAM,KADD;AAEL,WAAO,KAFF;AAGL,WAAO;AAHF,GAAP;AAKD,CAjBD;;AAoBA;;;;;;AAMA,gBAAgB,UAAhB,GAA6B,IAA7B;;AAGA;;;;;;AAMA,gBAAgB,aAAhB,GAAgC,GAAhC;;AAGA;;;;;;AAMA,gBAAgB,UAAhB,GAA6B,aAA7B;;AAGA;;;;;;AAMA,gBAAgB,eAAhB,GAAkC,KAAlC;;AAGA;;;;;;AAMA,gBAAgB,WAAhB,GAA8B,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,EAAb,EAAiB,EAAjB,CAA9B","file":"markerclusterer.js","sourcesContent":["/**\n * @name ClusterIconStyle\n * @class This class represents the object for values in the <code>styles</code> array passed\n *  to the {@link MarkerClusterer} constructor. The element in this array that is used to\n *  style the cluster icon is determined by calling the <code>calculator</code> function.\n *\n * @property {string} url The URL of the cluster icon image file. Required.\n * @property {number} height The display height (in pixels) of the cluster icon. Required.\n * @property {number} width The display width (in pixels) of the cluster icon. Required.\n * @property {Array} [anchorText] The position (in pixels) from the center of the cluster icon to\n *  where the text label is to be centered and drawn. The format is <code>[yoffset, xoffset]</code>\n *  where <code>yoffset</code> increases as you go down from center and <code>xoffset</code>\n *  increases to the right of center. The default is <code>[0, 0]</code>.\n * @property {Array} [anchorIcon] The anchor position (in pixels) of the cluster icon. This is the\n *  spot on the cluster icon that is to be aligned with the cluster position. The format is\n *  <code>[yoffset, xoffset]</code> where <code>yoffset</code> increases as you go down and\n *  <code>xoffset</code> increases to the right of the top-left corner of the icon. The default\n *  anchor position is the center of the cluster icon.\n * @property {string} [textColor=\"black\"] The color of the label text shown on the\n *  cluster icon.\n * @property {number} [textSize=11] The size (in pixels) of the label text shown on the\n *  cluster icon.\n * @property {string} [textDecoration=\"none\"] The value of the CSS <code>text-decoration</code>\n *  property for the label text shown on the cluster icon.\n * @property {string} [fontWeight=\"bold\"] The value of the CSS <code>font-weight</code>\n *  property for the label text shown on the cluster icon.\n * @property {string} [fontStyle=\"normal\"] The value of the CSS <code>font-style</code>\n *  property for the label text shown on the cluster icon.\n * @property {string} [fontFamily=\"Arial,sans-serif\"] The value of the CSS <code>font-family</code>\n *  property for the label text shown on the cluster icon.\n * @property {string} [backgroundPosition=\"0 0\"] The position of the cluster icon image\n *  within the image defined by <code>url</code>. The format is <code>\"xpos ypos\"</code>\n *  (the same format as for the CSS <code>background-position</code> property). You must set\n *  this property appropriately when the image defined by <code>url</code> represents a sprite\n *  containing multiple images. Note that the position <i>must</i> be specified in px units.\n */\n/**\n * @name ClusterIconInfo\n * @class This class is an object containing general information about a cluster icon. This is\n *  the object that a <code>calculator</code> function returns.\n *\n * @property {string} text The text of the label to be shown on the cluster icon.\n * @property {number} index The index plus 1 of the element in the <code>styles</code>\n *  array to be used to style the cluster icon.\n * @property {string} title The tooltip to display when the mouse moves over the cluster icon.\n *  If this value is <code>undefined</code> or <code>\"\"</code>, <code>title</code> is set to the\n *  value of the <code>title</code> property passed to the MarkerClusterer.\n */\n/**\n * A cluster icon.\n *\n * @constructor\n * @extends google.maps.OverlayView\n * @param {Cluster} cluster The cluster with which the icon is to be associated.\n * @param {Array} [styles] An array of {@link ClusterIconStyle} defining the cluster icons\n *  to use for various cluster sizes.\n * @private\n */\nfunction ClusterIcon(cluster, styles) {\n  cluster.getMarkerClusterer().extend(ClusterIcon, google.maps.OverlayView);\n\n  this.cluster_ = cluster;\n  this.className_ = cluster.getMarkerClusterer().getClusterClass();\n  this.styles_ = styles;\n  this.center_ = null;\n  this.div_ = null;\n  this.sums_ = null;\n  this.visible_ = false;\n\n  this.setMap(cluster.getMap()); // Note: this causes onAdd to be called\n}\n\n\n/**\n * Adds the icon to the DOM.\n */\nClusterIcon.prototype.onAdd = function () {\n  var cClusterIcon = this;\n  var cMouseDownInCluster;\n  var cDraggingMapByCluster;\n\n  this.div_ = document.createElement(\"div\");\n  this.div_.className = this.className_;\n  if (this.visible_) {\n    this.show();\n  }\n\n  this.getPanes().overlayMouseTarget.appendChild(this.div_);\n\n  // Fix for Issue 157\n  this.boundsChangedListener_ = google.maps.event.addListener(this.getMap(), \"bounds_changed\", function () {\n    cDraggingMapByCluster = cMouseDownInCluster;\n  });\n\n  google.maps.event.addDomListener(this.div_, \"mousedown\", function () {\n    cMouseDownInCluster = true;\n    cDraggingMapByCluster = false;\n  });\n\n  google.maps.event.addDomListener(this.div_, \"click\", function (e) {\n    cMouseDownInCluster = false;\n    if (!cDraggingMapByCluster) {\n      var theBounds;\n      var mz;\n      var mc = cClusterIcon.cluster_.getMarkerClusterer();\n      /**\n       * This event is fired when a cluster marker is clicked.\n       * @name MarkerClusterer#click\n       * @param {Cluster} c The cluster that was clicked.\n       * @event\n       */\n      google.maps.event.trigger(mc, \"click\", cClusterIcon.cluster_);\n      google.maps.event.trigger(mc, \"clusterclick\", cClusterIcon.cluster_); // deprecated name\n\n      // The default click handler follows. Disable it by setting\n      // the zoomOnClick property to false.\n      if (mc.getZoomOnClick()) {\n        // Zoom into the cluster.\n        mz = mc.getMaxZoom();\n        theBounds = cClusterIcon.cluster_.getBounds();\n        mc.getMap().fitBounds(theBounds);\n        // There is a fix for Issue 170 here:\n        setTimeout(function () {\n          mc.getMap().fitBounds(theBounds);\n          // Don't zoom beyond the max zoom level\n          if (mz !== null && (mc.getMap().getZoom() > mz)) {\n            mc.getMap().setZoom(mz + 1);\n          }\n        }, 100);\n      }\n\n      // Prevent event propagation to the map:\n      e.cancelBubble = true;\n      if (e.stopPropagation) {\n        e.stopPropagation();\n      }\n    }\n  });\n\n  google.maps.event.addDomListener(this.div_, \"mouseover\", function () {\n    var mc = cClusterIcon.cluster_.getMarkerClusterer();\n    /**\n     * This event is fired when the mouse moves over a cluster marker.\n     * @name MarkerClusterer#mouseover\n     * @param {Cluster} c The cluster that the mouse moved over.\n     * @event\n     */\n    google.maps.event.trigger(mc, \"mouseover\", cClusterIcon.cluster_);\n  });\n\n  google.maps.event.addDomListener(this.div_, \"mouseout\", function () {\n    var mc = cClusterIcon.cluster_.getMarkerClusterer();\n    /**\n     * This event is fired when the mouse moves out of a cluster marker.\n     * @name MarkerClusterer#mouseout\n     * @param {Cluster} c The cluster that the mouse moved out of.\n     * @event\n     */\n    google.maps.event.trigger(mc, \"mouseout\", cClusterIcon.cluster_);\n  });\n};\n\n\n/**\n * Removes the icon from the DOM.\n */\nClusterIcon.prototype.onRemove = function () {\n  if (this.div_ && this.div_.parentNode) {\n    this.hide();\n    google.maps.event.removeListener(this.boundsChangedListener_);\n    google.maps.event.clearInstanceListeners(this.div_);\n    this.div_.parentNode.removeChild(this.div_);\n    this.div_ = null;\n  }\n};\n\n\n/**\n * Draws the icon.\n */\nClusterIcon.prototype.draw = function () {\n  if (this.visible_) {\n    var pos = this.getPosFromLatLng_(this.center_);\n    this.div_.style.top = pos.y + \"px\";\n    this.div_.style.left = pos.x + \"px\";\n  }\n};\n\n\n/**\n * Hides the icon.\n */\nClusterIcon.prototype.hide = function () {\n  if (this.div_) {\n    this.div_.style.display = \"none\";\n  }\n  this.visible_ = false;\n};\n\n\n/**\n * Positions and shows the icon.\n */\nClusterIcon.prototype.show = function () {\n  if (this.div_) {\n    var img = \"\";\n    // NOTE: values must be specified in px units\n    var bp = this.backgroundPosition_.split(\" \");\n    var spriteH = parseInt(bp[0].replace(/^\\s+|\\s+$/g, \"\"), 10);\n    var spriteV = parseInt(bp[1].replace(/^\\s+|\\s+$/g, \"\"), 10);\n    var pos = this.getPosFromLatLng_(this.center_);\n    this.div_.style.cssText = this.createCss(pos);\n    img = \"<img src='\" + this.url_ + \"' style='position: absolute; top: \" + spriteV + \"px; left: \" + spriteH + \"px; \";\n    if (!this.cluster_.getMarkerClusterer().enableRetinaIcons_) {\n      img += \"clip: rect(\" + (-1 * spriteV) + \"px, \" + ((-1 * spriteH) + this.width_) + \"px, \" +\n          ((-1 * spriteV) + this.height_) + \"px, \" + (-1 * spriteH) + \"px);\";\n    }\n    img += \"'>\";\n    this.div_.innerHTML = img + \"<div style='\" +\n        \"position: absolute;\" +\n        \"top: \" + this.anchorText_[0] + \"px;\" +\n        \"left: \" + this.anchorText_[1] + \"px;\" +\n        \"color: \" + this.textColor_ + \";\" +\n        \"font-size: \" + this.textSize_ + \"px;\" +\n        \"font-family: \" + this.fontFamily_ + \";\" +\n        \"font-weight: \" + this.fontWeight_ + \";\" +\n        \"font-style: \" + this.fontStyle_ + \";\" +\n        \"text-decoration: \" + this.textDecoration_ + \";\" +\n        \"text-align: center;\" +\n        \"width: \" + this.width_ + \"px;\" +\n        \"line-height:\" + this.height_ + \"px;\" +\n        \"'>\" + this.sums_.text + \"</div>\";\n    if (typeof this.sums_.title === \"undefined\" || this.sums_.title === \"\") {\n      this.div_.title = this.cluster_.getMarkerClusterer().getTitle();\n    } else {\n      this.div_.title = this.sums_.title;\n    }\n    this.div_.style.display = \"\";\n  }\n  this.visible_ = true;\n};\n\n\n/**\n * Sets the icon styles to the appropriate element in the styles array.\n *\n * @param {ClusterIconInfo} sums The icon label text and styles index.\n */\nClusterIcon.prototype.useStyle = function (sums) {\n  this.sums_ = sums;\n  var index = Math.max(0, sums.index - 1);\n  index = Math.min(this.styles_.length - 1, index);\n  var style = this.styles_[index];\n  this.url_ = style.url;\n  this.height_ = style.height;\n  this.width_ = style.width;\n  this.anchorText_ = style.anchorText || [0, 0];\n  this.anchorIcon_ = style.anchorIcon || [parseInt(this.height_ / 2, 10), parseInt(this.width_ / 2, 10)];\n  this.textColor_ = style.textColor || \"black\";\n  this.textSize_ = style.textSize || 11;\n  this.textDecoration_ = style.textDecoration || \"none\";\n  this.fontWeight_ = style.fontWeight || \"bold\";\n  this.fontStyle_ = style.fontStyle || \"normal\";\n  this.fontFamily_ = style.fontFamily || \"Arial,sans-serif\";\n  this.backgroundPosition_ = style.backgroundPosition || \"0 0\";\n};\n\n\n/**\n * Sets the position at which to center the icon.\n *\n * @param {google.maps.LatLng} center The latlng to set as the center.\n */\nClusterIcon.prototype.setCenter = function (center) {\n  this.center_ = center;\n};\n\n\n/**\n * Creates the cssText style parameter based on the position of the icon.\n *\n * @param {google.maps.Point} pos The position of the icon.\n * @return {string} The CSS style text.\n */\nClusterIcon.prototype.createCss = function (pos) {\n  var style = [];\n  style.push(\"cursor: pointer;\");\n  style.push(\"position: absolute; top: \" + pos.y + \"px; left: \" + pos.x + \"px;\");\n  style.push(\"width: \" + this.width_ + \"px; height: \" + this.height_ + \"px;\");\n  return style.join(\"\");\n};\n\n\n/**\n * Returns the position at which to place the DIV depending on the latlng.\n *\n * @param {google.maps.LatLng} latlng The position in latlng.\n * @return {google.maps.Point} The position in pixels.\n */\nClusterIcon.prototype.getPosFromLatLng_ = function (latlng) {\n  var pos = this.getProjection().fromLatLngToDivPixel(latlng);\n  pos.x -= this.anchorIcon_[1];\n  pos.y -= this.anchorIcon_[0];\n  pos.x = parseInt(pos.x, 10);\n  pos.y = parseInt(pos.y, 10);\n  return pos;\n};\n\n\n/**\n * Creates a single cluster that manages a group of proximate markers.\n *  Used internally, do not call this constructor directly.\n * @constructor\n * @param {MarkerClusterer} mc The <code>MarkerClusterer</code> object with which this\n *  cluster is associated.\n */\nfunction Cluster(mc) {\n  this.markerClusterer_ = mc;\n  this.map_ = mc.getMap();\n  this.gridSize_ = mc.getGridSize();\n  this.minClusterSize_ = mc.getMinimumClusterSize();\n  this.averageCenter_ = mc.getAverageCenter();\n  this.markers_ = [];\n  this.center_ = null;\n  this.bounds_ = null;\n  this.clusterIcon_ = new ClusterIcon(this, mc.getStyles());\n}\n\n\n/**\n * Returns the number of markers managed by the cluster. You can call this from\n * a <code>click</code>, <code>mouseover</code>, or <code>mouseout</code> event handler\n * for the <code>MarkerClusterer</code> object.\n *\n * @return {number} The number of markers in the cluster.\n */\nCluster.prototype.getSize = function () {\n  return this.markers_.length;\n};\n\n\n/**\n * Returns the array of markers managed by the cluster. You can call this from\n * a <code>click</code>, <code>mouseover</code>, or <code>mouseout</code> event handler\n * for the <code>MarkerClusterer</code> object.\n *\n * @return {Array} The array of markers in the cluster.\n */\nCluster.prototype.getMarkers = function () {\n  return this.markers_;\n};\n\n\n/**\n * Returns the center of the cluster. You can call this from\n * a <code>click</code>, <code>mouseover</code>, or <code>mouseout</code> event handler\n * for the <code>MarkerClusterer</code> object.\n *\n * @return {google.maps.LatLng} The center of the cluster.\n */\nCluster.prototype.getCenter = function () {\n  return this.center_;\n};\n\n\n/**\n * Returns the map with which the cluster is associated.\n *\n * @return {google.maps.Map} The map.\n * @ignore\n */\nCluster.prototype.getMap = function () {\n  return this.map_;\n};\n\n\n/**\n * Returns the <code>MarkerClusterer</code> object with which the cluster is associated.\n *\n * @return {MarkerClusterer} The associated marker clusterer.\n * @ignore\n */\nCluster.prototype.getMarkerClusterer = function () {\n  return this.markerClusterer_;\n};\n\n\n/**\n * Returns the bounds of the cluster.\n *\n * @return {google.maps.LatLngBounds} the cluster bounds.\n * @ignore\n */\nCluster.prototype.getBounds = function () {\n  var i;\n  var bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n  var markers = this.getMarkers();\n  for (i = 0; i < markers.length; i++) {\n    bounds.extend(markers[i].getPosition());\n  }\n  return bounds;\n};\n\n\n/**\n * Removes the cluster from the map.\n *\n * @ignore\n */\nCluster.prototype.remove = function () {\n  this.clusterIcon_.setMap(null);\n  this.markers_ = [];\n  delete this.markers_;\n};\n\n\n/**\n * Adds a marker to the cluster.\n *\n * @param {google.maps.Marker} marker The marker to be added.\n * @return {boolean} True if the marker was added.\n * @ignore\n */\nCluster.prototype.addMarker = function (marker) {\n  var i;\n  var mCount;\n  var mz;\n\n  if (this.isMarkerAlreadyAdded_(marker)) {\n    return false;\n  }\n\n  if (!this.center_) {\n    this.center_ = marker.getPosition();\n    this.calculateBounds_();\n  } else {\n    if (this.averageCenter_) {\n      var l = this.markers_.length + 1;\n      var lat = (this.center_.lat() * (l - 1) + marker.getPosition().lat()) / l;\n      var lng = (this.center_.lng() * (l - 1) + marker.getPosition().lng()) / l;\n      this.center_ = new google.maps.LatLng(lat, lng);\n      this.calculateBounds_();\n    }\n  }\n\n  marker.isAdded = true;\n  this.markers_.push(marker);\n\n  mCount = this.markers_.length;\n  mz = this.markerClusterer_.getMaxZoom();\n  if (mz !== null && this.map_.getZoom() > mz) {\n    // Zoomed in past max zoom, so show the marker.\n    if (marker.getMap() !== this.map_) {\n      marker.setMap(this.map_);\n    }\n  } else if (mCount < this.minClusterSize_) {\n    // Min cluster size not reached so show the marker.\n    if (marker.getMap() !== this.map_) {\n      marker.setMap(this.map_);\n    }\n  } else if (mCount === this.minClusterSize_) {\n    // Hide the markers that were showing.\n    for (i = 0; i < mCount; i++) {\n      this.markers_[i].setMap(null);\n    }\n  } else {\n    marker.setMap(null);\n  }\n\n  this.updateIcon_();\n  return true;\n};\n\n\n/**\n * Determines if a marker lies within the cluster's bounds.\n *\n * @param {google.maps.Marker} marker The marker to check.\n * @return {boolean} True if the marker lies in the bounds.\n * @ignore\n */\nCluster.prototype.isMarkerInClusterBounds = function (marker) {\n  return this.bounds_.contains(marker.getPosition());\n};\n\n\n/**\n * Calculates the extended bounds of the cluster with the grid.\n */\nCluster.prototype.calculateBounds_ = function () {\n  var bounds = new google.maps.LatLngBounds(this.center_, this.center_);\n  this.bounds_ = this.markerClusterer_.getExtendedBounds(bounds);\n};\n\n\n/**\n * Updates the cluster icon.\n */\nCluster.prototype.updateIcon_ = function () {\n  var mCount = this.markers_.length;\n  var mz = this.markerClusterer_.getMaxZoom();\n\n  if (mz !== null && this.map_.getZoom() > mz) {\n    this.clusterIcon_.hide();\n    return;\n  }\n\n  if (mCount < this.minClusterSize_) {\n    // Min cluster size not yet reached.\n    this.clusterIcon_.hide();\n    return;\n  }\n\n  var numStyles = this.markerClusterer_.getStyles().length;\n  var sums = this.markerClusterer_.getCalculator()(this.markers_, numStyles);\n  this.clusterIcon_.setCenter(this.center_);\n  this.clusterIcon_.useStyle(sums);\n  this.clusterIcon_.show();\n};\n\n\n/**\n * Determines if a marker has already been added to the cluster.\n *\n * @param {google.maps.Marker} marker The marker to check.\n * @return {boolean} True if the marker has already been added.\n */\nCluster.prototype.isMarkerAlreadyAdded_ = function (marker) {\n  var i;\n  if (this.markers_.indexOf) {\n    return this.markers_.indexOf(marker) !== -1;\n  } else {\n    for (i = 0; i < this.markers_.length; i++) {\n      if (marker === this.markers_[i]) {\n        return true;\n      }\n    }\n  }\n  return false;\n};\n\n\n/**\n * @name MarkerClustererOptions\n * @class This class represents the optional parameter passed to\n *  the {@link MarkerClusterer} constructor.\n * @property {number} [gridSize=60] The grid size of a cluster in pixels. The grid is a square.\n * @property {number} [maxZoom=null] The maximum zoom level at which clustering is enabled or\n *  <code>null</code> if clustering is to be enabled at all zoom levels.\n * @property {boolean} [zoomOnClick=true] Whether to zoom the map when a cluster marker is\n *  clicked. You may want to set this to <code>false</code> if you have installed a handler\n *  for the <code>click</code> event and it deals with zooming on its own.\n * @property {boolean} [averageCenter=false] Whether the position of a cluster marker should be\n *  the average position of all markers in the cluster. If set to <code>false</code>, the\n *  cluster marker is positioned at the location of the first marker added to the cluster.\n * @property {number} [minimumClusterSize=2] The minimum number of markers needed in a cluster\n *  before the markers are hidden and a cluster marker appears.\n * @property {boolean} [ignoreHidden=false] Whether to ignore hidden markers in clusters. You\n *  may want to set this to <code>true</code> to ensure that hidden markers are not included\n *  in the marker count that appears on a cluster marker (this count is the value of the\n *  <code>text</code> property of the result returned by the default <code>calculator</code>).\n *  If set to <code>true</code> and you change the visibility of a marker being clustered, be\n *  sure to also call <code>MarkerClusterer.repaint()</code>.\n * @property {string} [title=\"\"] The tooltip to display when the mouse moves over a cluster\n *  marker. (Alternatively, you can use a custom <code>calculator</code> function to specify a\n *  different tooltip for each cluster marker.)\n * @property {function} [calculator=MarkerClusterer.CALCULATOR] The function used to determine\n *  the text to be displayed on a cluster marker and the index indicating which style to use\n *  for the cluster marker. The input parameters for the function are (1) the array of markers\n *  represented by a cluster marker and (2) the number of cluster icon styles. It returns a\n *  {@link ClusterIconInfo} object. The default <code>calculator</code> returns a\n *  <code>text</code> property which is the number of markers in the cluster and an\n *  <code>index</code> property which is one higher than the lowest integer such that\n *  <code>10^i</code> exceeds the number of markers in the cluster, or the size of the styles\n *  array, whichever is less. The <code>styles</code> array element used has an index of\n *  <code>index</code> minus 1. For example, the default <code>calculator</code> returns a\n *  <code>text</code> value of <code>\"125\"</code> and an <code>index</code> of <code>3</code>\n *  for a cluster icon representing 125 markers so the element used in the <code>styles</code>\n *  array is <code>2</code>. A <code>calculator</code> may also return a <code>title</code>\n *  property that contains the text of the tooltip to be used for the cluster marker. If\n *   <code>title</code> is not defined, the tooltip is set to the value of the <code>title</code>\n *   property for the MarkerClusterer.\n * @property {string} [clusterClass=\"cluster\"] The name of the CSS class defining general styles\n *  for the cluster markers. Use this class to define CSS styles that are not set up by the code\n *  that processes the <code>styles</code> array.\n * @property {Array} [styles] An array of {@link ClusterIconStyle} elements defining the styles\n *  of the cluster markers to be used. The element to be used to style a given cluster marker\n *  is determined by the function defined by the <code>calculator</code> property.\n *  The default is an array of {@link ClusterIconStyle} elements whose properties are derived\n *  from the values for <code>imagePath</code>, <code>imageExtension</code>, and\n *  <code>imageSizes</code>.\n * @property {boolean} [enableRetinaIcons=false] Whether to allow the use of cluster icons that\n * have sizes that are some multiple (typically double) of their actual display size. Icons such\n * as these look better when viewed on high-resolution monitors such as Apple's Retina displays.\n * Note: if this property is <code>true</code>, sprites cannot be used as cluster icons.\n * @property {number} [batchSize=MarkerClusterer.BATCH_SIZE] Set this property to the\n *  number of markers to be processed in a single batch when using a browser other than\n *  Internet Explorer (for Internet Explorer, use the batchSizeIE property instead).\n * @property {number} [batchSizeIE=MarkerClusterer.BATCH_SIZE_IE] When Internet Explorer is\n *  being used, markers are processed in several batches with a small delay inserted between\n *  each batch in an attempt to avoid Javascript timeout errors. Set this property to the\n *  number of markers to be processed in a single batch; select as high a number as you can\n *  without causing a timeout error in the browser. This number might need to be as low as 100\n *  if 15,000 markers are being managed, for example.\n * @property {string} [imagePath=MarkerClusterer.IMAGE_PATH]\n *  The full URL of the root name of the group of image files to use for cluster icons.\n *  The complete file name is of the form <code>imagePath</code>n.<code>imageExtension</code>\n *  where n is the image file number (1, 2, etc.).\n * @property {string} [imageExtension=MarkerClusterer.IMAGE_EXTENSION]\n *  The extension name for the cluster icon image files (e.g., <code>\"png\"</code> or\n *  <code>\"jpg\"</code>).\n * @property {Array} [imageSizes=MarkerClusterer.IMAGE_SIZES]\n *  An array of numbers containing the widths of the group of\n *  <code>imagePath</code>n.<code>imageExtension</code> image files.\n *  (The images are assumed to be square.)\n */\n/**\n * Creates a MarkerClusterer object with the options specified in {@link MarkerClustererOptions}.\n * @constructor\n * @extends google.maps.OverlayView\n * @param {google.maps.Map} map The Google map to attach to.\n * @param {Array.<google.maps.Marker>} [opt_markers] The markers to be added to the cluster.\n * @param {MarkerClustererOptions} [opt_options] The optional parameters.\n */\nfunction MarkerClusterer(map, opt_markers, opt_options) {\n  // MarkerClusterer implements google.maps.OverlayView interface. We use the\n  // extend function to extend MarkerClusterer with google.maps.OverlayView\n  // because it might not always be available when the code is defined so we\n  // look for it at the last possible moment. If it doesn't exist now then\n  // there is no point going ahead :)\n  this.extend(MarkerClusterer, google.maps.OverlayView);\n\n  opt_markers = opt_markers || [];\n  opt_options = opt_options || {};\n\n  this.markers_ = [];\n  this.clusters_ = [];\n  this.listeners_ = [];\n  this.activeMap_ = null;\n  this.ready_ = false;\n\n  this.gridSize_ = opt_options.gridSize || 60;\n  this.minClusterSize_ = opt_options.minimumClusterSize || 2;\n  this.maxZoom_ = opt_options.maxZoom || null;\n  this.styles_ = opt_options.styles || [];\n  this.title_ = opt_options.title || \"\";\n  this.zoomOnClick_ = true;\n  if (opt_options.zoomOnClick !== undefined) {\n    this.zoomOnClick_ = opt_options.zoomOnClick;\n  }\n  this.averageCenter_ = false;\n  if (opt_options.averageCenter !== undefined) {\n    this.averageCenter_ = opt_options.averageCenter;\n  }\n  this.ignoreHidden_ = false;\n  if (opt_options.ignoreHidden !== undefined) {\n    this.ignoreHidden_ = opt_options.ignoreHidden;\n  }\n  this.enableRetinaIcons_ = false;\n  if (opt_options.enableRetinaIcons !== undefined) {\n    this.enableRetinaIcons_ = opt_options.enableRetinaIcons;\n  }\n  this.imagePath_ = opt_options.imagePath || MarkerClusterer.IMAGE_PATH;\n  this.imageExtension_ = opt_options.imageExtension || MarkerClusterer.IMAGE_EXTENSION;\n  this.imageSizes_ = opt_options.imageSizes || MarkerClusterer.IMAGE_SIZES;\n  this.calculator_ = opt_options.calculator || MarkerClusterer.CALCULATOR;\n  this.batchSize_ = opt_options.batchSize || MarkerClusterer.BATCH_SIZE;\n  this.batchSizeIE_ = opt_options.batchSizeIE || MarkerClusterer.BATCH_SIZE_IE;\n  this.clusterClass_ = opt_options.clusterClass || \"cluster\";\n\n  if (navigator.userAgent.toLowerCase().indexOf(\"msie\") !== -1) {\n    // Try to avoid IE timeout when processing a huge number of markers:\n    this.batchSize_ = this.batchSizeIE_;\n  }\n\n  this.setupStyles_();\n\n  this.addMarkers(opt_markers, true);\n  this.setMap(map); // Note: this causes onAdd to be called\n}\n\n\n/**\n * Implementation of the onAdd interface method.\n * @ignore\n */\nMarkerClusterer.prototype.onAdd = function () {\n  var cMarkerClusterer = this;\n\n  this.activeMap_ = this.getMap();\n  this.ready_ = true;\n\n  this.repaint();\n\n  // Add the map event listeners\n  this.listeners_ = [\n    google.maps.event.addListener(this.getMap(), \"zoom_changed\", function () {\n      cMarkerClusterer.resetViewport_(false);\n      // Workaround for this Google bug: when map is at level 0 and \"-\" of\n      // zoom slider is clicked, a \"zoom_changed\" event is fired even though\n      // the map doesn't zoom out any further. In this situation, no \"idle\"\n      // event is triggered so the cluster markers that have been removed\n      // do not get redrawn. Same goes for a zoom in at maxZoom.\n      if (this.getZoom() === (this.get(\"minZoom\") || 0) || this.getZoom() === this.get(\"maxZoom\")) {\n        google.maps.event.trigger(this, \"idle\");\n      }\n    }),\n    google.maps.event.addListener(this.getMap(), \"idle\", function () {\n      cMarkerClusterer.redraw_();\n    })\n  ];\n};\n\n\n/**\n * Implementation of the onRemove interface method.\n * Removes map event listeners and all cluster icons from the DOM.\n * All managed markers are also put back on the map.\n * @ignore\n */\nMarkerClusterer.prototype.onRemove = function () {\n  var i;\n\n  // Put all the managed markers back on the map:\n  for (i = 0; i < this.markers_.length; i++) {\n    if (this.markers_[i].getMap() !== this.activeMap_) {\n      this.markers_[i].setMap(this.activeMap_);\n    }\n  }\n\n  // Remove all clusters:\n  for (i = 0; i < this.clusters_.length; i++) {\n    this.clusters_[i].remove();\n  }\n  this.clusters_ = [];\n\n  // Remove map event listeners:\n  for (i = 0; i < this.listeners_.length; i++) {\n    google.maps.event.removeListener(this.listeners_[i]);\n  }\n  this.listeners_ = [];\n\n  this.activeMap_ = null;\n  this.ready_ = false;\n};\n\n\n/**\n * Implementation of the draw interface method.\n * @ignore\n */\nMarkerClusterer.prototype.draw = function () {};\n\n\n/**\n * Sets up the styles object.\n */\nMarkerClusterer.prototype.setupStyles_ = function () {\n  var i, size;\n  if (this.styles_.length > 0) {\n    return;\n  }\n\n  for (i = 0; i < this.imageSizes_.length; i++) {\n    size = this.imageSizes_[i];\n    this.styles_.push({\n      url: this.imagePath_ + (i + 1) + \".\" + this.imageExtension_,\n      height: size,\n      width: size\n    });\n  }\n};\n\n\n/**\n *  Fits the map to the bounds of the markers managed by the clusterer.\n */\nMarkerClusterer.prototype.fitMapToMarkers = function () {\n  var i;\n  var markers = this.getMarkers();\n  var bounds = new google.maps.LatLngBounds();\n  for (i = 0; i < markers.length; i++) {\n    bounds.extend(markers[i].getPosition());\n  }\n\n  this.getMap().fitBounds(bounds);\n};\n\n\n/**\n * Returns the value of the <code>gridSize</code> property.\n *\n * @return {number} The grid size.\n */\nMarkerClusterer.prototype.getGridSize = function () {\n  return this.gridSize_;\n};\n\n\n/**\n * Sets the value of the <code>gridSize</code> property.\n *\n * @param {number} gridSize The grid size.\n */\nMarkerClusterer.prototype.setGridSize = function (gridSize) {\n  this.gridSize_ = gridSize;\n};\n\n\n/**\n * Returns the value of the <code>minimumClusterSize</code> property.\n *\n * @return {number} The minimum cluster size.\n */\nMarkerClusterer.prototype.getMinimumClusterSize = function () {\n  return this.minClusterSize_;\n};\n\n/**\n * Sets the value of the <code>minimumClusterSize</code> property.\n *\n * @param {number} minimumClusterSize The minimum cluster size.\n */\nMarkerClusterer.prototype.setMinimumClusterSize = function (minimumClusterSize) {\n  this.minClusterSize_ = minimumClusterSize;\n};\n\n\n/**\n *  Returns the value of the <code>maxZoom</code> property.\n *\n *  @return {number} The maximum zoom level.\n */\nMarkerClusterer.prototype.getMaxZoom = function () {\n  return this.maxZoom_;\n};\n\n\n/**\n *  Sets the value of the <code>maxZoom</code> property.\n *\n *  @param {number} maxZoom The maximum zoom level.\n */\nMarkerClusterer.prototype.setMaxZoom = function (maxZoom) {\n  this.maxZoom_ = maxZoom;\n};\n\n\n/**\n *  Returns the value of the <code>styles</code> property.\n *\n *  @return {Array} The array of styles defining the cluster markers to be used.\n */\nMarkerClusterer.prototype.getStyles = function () {\n  return this.styles_;\n};\n\n\n/**\n *  Sets the value of the <code>styles</code> property.\n *\n *  @param {Array.<ClusterIconStyle>} styles The array of styles to use.\n */\nMarkerClusterer.prototype.setStyles = function (styles) {\n  this.styles_ = styles;\n};\n\n\n/**\n * Returns the value of the <code>title</code> property.\n *\n * @return {string} The content of the title text.\n */\nMarkerClusterer.prototype.getTitle = function () {\n  return this.title_;\n};\n\n\n/**\n *  Sets the value of the <code>title</code> property.\n *\n *  @param {string} title The value of the title property.\n */\nMarkerClusterer.prototype.setTitle = function (title) {\n  this.title_ = title;\n};\n\n\n/**\n * Returns the value of the <code>zoomOnClick</code> property.\n *\n * @return {boolean} True if zoomOnClick property is set.\n */\nMarkerClusterer.prototype.getZoomOnClick = function () {\n  return this.zoomOnClick_;\n};\n\n\n/**\n *  Sets the value of the <code>zoomOnClick</code> property.\n *\n *  @param {boolean} zoomOnClick The value of the zoomOnClick property.\n */\nMarkerClusterer.prototype.setZoomOnClick = function (zoomOnClick) {\n  this.zoomOnClick_ = zoomOnClick;\n};\n\n\n/**\n * Returns the value of the <code>averageCenter</code> property.\n *\n * @return {boolean} True if averageCenter property is set.\n */\nMarkerClusterer.prototype.getAverageCenter = function () {\n  return this.averageCenter_;\n};\n\n\n/**\n *  Sets the value of the <code>averageCenter</code> property.\n *\n *  @param {boolean} averageCenter The value of the averageCenter property.\n */\nMarkerClusterer.prototype.setAverageCenter = function (averageCenter) {\n  this.averageCenter_ = averageCenter;\n};\n\n\n/**\n * Returns the value of the <code>ignoreHidden</code> property.\n *\n * @return {boolean} True if ignoreHidden property is set.\n */\nMarkerClusterer.prototype.getIgnoreHidden = function () {\n  return this.ignoreHidden_;\n};\n\n\n/**\n *  Sets the value of the <code>ignoreHidden</code> property.\n *\n *  @param {boolean} ignoreHidden The value of the ignoreHidden property.\n */\nMarkerClusterer.prototype.setIgnoreHidden = function (ignoreHidden) {\n  this.ignoreHidden_ = ignoreHidden;\n};\n\n\n/**\n * Returns the value of the <code>enableRetinaIcons</code> property.\n *\n * @return {boolean} True if enableRetinaIcons property is set.\n */\nMarkerClusterer.prototype.getEnableRetinaIcons = function () {\n  return this.enableRetinaIcons_;\n};\n\n\n/**\n *  Sets the value of the <code>enableRetinaIcons</code> property.\n *\n *  @param {boolean} enableRetinaIcons The value of the enableRetinaIcons property.\n */\nMarkerClusterer.prototype.setEnableRetinaIcons = function (enableRetinaIcons) {\n  this.enableRetinaIcons_ = enableRetinaIcons;\n};\n\n\n/**\n * Returns the value of the <code>imageExtension</code> property.\n *\n * @return {string} The value of the imageExtension property.\n */\nMarkerClusterer.prototype.getImageExtension = function () {\n  return this.imageExtension_;\n};\n\n\n/**\n *  Sets the value of the <code>imageExtension</code> property.\n *\n *  @param {string} imageExtension The value of the imageExtension property.\n */\nMarkerClusterer.prototype.setImageExtension = function (imageExtension) {\n  this.imageExtension_ = imageExtension;\n};\n\n\n/**\n * Returns the value of the <code>imagePath</code> property.\n *\n * @return {string} The value of the imagePath property.\n */\nMarkerClusterer.prototype.getImagePath = function () {\n  return this.imagePath_;\n};\n\n\n/**\n *  Sets the value of the <code>imagePath</code> property.\n *\n *  @param {string} imagePath The value of the imagePath property.\n */\nMarkerClusterer.prototype.setImagePath = function (imagePath) {\n  this.imagePath_ = imagePath;\n};\n\n\n/**\n * Returns the value of the <code>imageSizes</code> property.\n *\n * @return {Array} The value of the imageSizes property.\n */\nMarkerClusterer.prototype.getImageSizes = function () {\n  return this.imageSizes_;\n};\n\n\n/**\n *  Sets the value of the <code>imageSizes</code> property.\n *\n *  @param {Array} imageSizes The value of the imageSizes property.\n */\nMarkerClusterer.prototype.setImageSizes = function (imageSizes) {\n  this.imageSizes_ = imageSizes;\n};\n\n\n/**\n * Returns the value of the <code>calculator</code> property.\n *\n * @return {function} the value of the calculator property.\n */\nMarkerClusterer.prototype.getCalculator = function () {\n  return this.calculator_;\n};\n\n\n/**\n * Sets the value of the <code>calculator</code> property.\n *\n * @param {function(Array.<google.maps.Marker>, number)} calculator The value\n *  of the calculator property.\n */\nMarkerClusterer.prototype.setCalculator = function (calculator) {\n  this.calculator_ = calculator;\n};\n\n\n/**\n * Returns the value of the <code>batchSizeIE</code> property.\n *\n * @return {number} the value of the batchSizeIE property.\n */\nMarkerClusterer.prototype.getBatchSizeIE = function () {\n  return this.batchSizeIE_;\n};\n\n\n/**\n * Sets the value of the <code>batchSizeIE</code> property.\n *\n *  @param {number} batchSizeIE The value of the batchSizeIE property.\n */\nMarkerClusterer.prototype.setBatchSizeIE = function (batchSizeIE) {\n  this.batchSizeIE_ = batchSizeIE;\n};\n\n\n/**\n * Returns the value of the <code>clusterClass</code> property.\n *\n * @return {string} the value of the clusterClass property.\n */\nMarkerClusterer.prototype.getClusterClass = function () {\n  return this.clusterClass_;\n};\n\n\n/**\n * Sets the value of the <code>clusterClass</code> property.\n *\n *  @param {string} clusterClass The value of the clusterClass property.\n */\nMarkerClusterer.prototype.setClusterClass = function (clusterClass) {\n  this.clusterClass_ = clusterClass;\n};\n\n\n/**\n *  Returns the array of markers managed by the clusterer.\n *\n *  @return {Array} The array of markers managed by the clusterer.\n */\nMarkerClusterer.prototype.getMarkers = function () {\n  return this.markers_;\n};\n\n\n/**\n *  Returns the number of markers managed by the clusterer.\n *\n *  @return {number} The number of markers.\n */\nMarkerClusterer.prototype.getTotalMarkers = function () {\n  return this.markers_.length;\n};\n\n\n/**\n * Returns the current array of clusters formed by the clusterer.\n *\n * @return {Array} The array of clusters formed by the clusterer.\n */\nMarkerClusterer.prototype.getClusters = function () {\n  return this.clusters_;\n};\n\n\n/**\n * Returns the number of clusters formed by the clusterer.\n *\n * @return {number} The number of clusters formed by the clusterer.\n */\nMarkerClusterer.prototype.getTotalClusters = function () {\n  return this.clusters_.length;\n};\n\n\n/**\n * Adds a marker to the clusterer. The clusters are redrawn unless\n *  <code>opt_nodraw</code> is set to <code>true</code>.\n *\n * @param {google.maps.Marker} marker The marker to add.\n * @param {boolean} [opt_nodraw] Set to <code>true</code> to prevent redrawing.\n */\nMarkerClusterer.prototype.addMarker = function (marker, opt_nodraw) {\n  this.pushMarkerTo_(marker);\n  if (!opt_nodraw) {\n    this.redraw_();\n  }\n};\n\n\n/**\n * Adds an array of markers to the clusterer. The clusters are redrawn unless\n *  <code>opt_nodraw</code> is set to <code>true</code>.\n *\n * @param {Array.<google.maps.Marker>} markers The markers to add.\n * @param {boolean} [opt_nodraw] Set to <code>true</code> to prevent redrawing.\n */\nMarkerClusterer.prototype.addMarkers = function (markers, opt_nodraw) {\n  var key;\n  for (key in markers) {\n    if (markers.hasOwnProperty(key)) {\n      this.pushMarkerTo_(markers[key]);\n    }\n  }  \n  if (!opt_nodraw) {\n    this.redraw_();\n  }\n};\n\n\n/**\n * Pushes a marker to the clusterer.\n *\n * @param {google.maps.Marker} marker The marker to add.\n */\nMarkerClusterer.prototype.pushMarkerTo_ = function (marker) {\n  // If the marker is draggable add a listener so we can update the clusters on the dragend:\n  if (marker.getDraggable()) {\n    var cMarkerClusterer = this;\n    google.maps.event.addListener(marker, \"dragend\", function () {\n      if (cMarkerClusterer.ready_) {\n        this.isAdded = false;\n        cMarkerClusterer.repaint();\n      }\n    });\n  }\n  marker.isAdded = false;\n  this.markers_.push(marker);\n};\n\n\n/**\n * Removes a marker from the cluster.  The clusters are redrawn unless\n *  <code>opt_nodraw</code> is set to <code>true</code>. Returns <code>true</code> if the\n *  marker was removed from the clusterer.\n *\n * @param {google.maps.Marker} marker The marker to remove.\n * @param {boolean} [opt_nodraw] Set to <code>true</code> to prevent redrawing.\n * @return {boolean} True if the marker was removed from the clusterer.\n */\nMarkerClusterer.prototype.removeMarker = function (marker, opt_nodraw) {\n  var removed = this.removeMarker_(marker);\n\n  if (!opt_nodraw && removed) {\n    this.repaint();\n  }\n\n  return removed;\n};\n\n\n/**\n * Removes an array of markers from the cluster. The clusters are redrawn unless\n *  <code>opt_nodraw</code> is set to <code>true</code>. Returns <code>true</code> if markers\n *  were removed from the clusterer.\n *\n * @param {Array.<google.maps.Marker>} markers The markers to remove.\n * @param {boolean} [opt_nodraw] Set to <code>true</code> to prevent redrawing.\n * @return {boolean} True if markers were removed from the clusterer.\n */\nMarkerClusterer.prototype.removeMarkers = function (markers, opt_nodraw) {\n  var i, r;\n  var removed = false;\n\n  for (i = 0; i < markers.length; i++) {\n    r = this.removeMarker_(markers[i]);\n    removed = removed || r;\n  }\n\n  if (!opt_nodraw && removed) {\n    this.repaint();\n  }\n\n  return removed;\n};\n\n\n/**\n * Removes a marker and returns true if removed, false if not.\n *\n * @param {google.maps.Marker} marker The marker to remove\n * @return {boolean} Whether the marker was removed or not\n */\nMarkerClusterer.prototype.removeMarker_ = function (marker) {\n  var i;\n  var index = -1;\n  if (this.markers_.indexOf) {\n    index = this.markers_.indexOf(marker);\n  } else {\n    for (i = 0; i < this.markers_.length; i++) {\n      if (marker === this.markers_[i]) {\n        index = i;\n        break;\n      }\n    }\n  }\n\n  if (index === -1) {\n    // Marker is not in our list of markers, so do nothing:\n    return false;\n  }\n\n  marker.setMap(null);\n  this.markers_.splice(index, 1); // Remove the marker from the list of managed markers\n  return true;\n};\n\n\n/**\n * Removes all clusters and markers from the map and also removes all markers\n *  managed by the clusterer.\n */\nMarkerClusterer.prototype.clearMarkers = function () {\n  this.resetViewport_(true);\n  this.markers_ = [];\n};\n\n\n/**\n * Recalculates and redraws all the marker clusters from scratch.\n *  Call this after changing any properties.\n */\nMarkerClusterer.prototype.repaint = function () {\n  var oldClusters = this.clusters_.slice();\n  this.clusters_ = [];\n  this.resetViewport_(false);\n  this.redraw_();\n\n  // Remove the old clusters.\n  // Do it in a timeout to prevent blinking effect.\n  setTimeout(function () {\n    var i;\n    for (i = 0; i < oldClusters.length; i++) {\n      oldClusters[i].remove();\n    }\n  }, 0);\n};\n\n\n/**\n * Returns the current bounds extended by the grid size.\n *\n * @param {google.maps.LatLngBounds} bounds The bounds to extend.\n * @return {google.maps.LatLngBounds} The extended bounds.\n * @ignore\n */\nMarkerClusterer.prototype.getExtendedBounds = function (bounds) {\n  var projection = this.getProjection();\n\n  // Turn the bounds into latlng.\n  var tr = new google.maps.LatLng(bounds.getNorthEast().lat(),\n      bounds.getNorthEast().lng());\n  var bl = new google.maps.LatLng(bounds.getSouthWest().lat(),\n      bounds.getSouthWest().lng());\n\n  // Convert the points to pixels and the extend out by the grid size.\n  var trPix = projection.fromLatLngToDivPixel(tr);\n  trPix.x += this.gridSize_;\n  trPix.y -= this.gridSize_;\n\n  var blPix = projection.fromLatLngToDivPixel(bl);\n  blPix.x -= this.gridSize_;\n  blPix.y += this.gridSize_;\n\n  // Convert the pixel points back to LatLng\n  var ne = projection.fromDivPixelToLatLng(trPix);\n  var sw = projection.fromDivPixelToLatLng(blPix);\n\n  // Extend the bounds to contain the new bounds.\n  bounds.extend(ne);\n  bounds.extend(sw);\n\n  return bounds;\n};\n\n\n/**\n * Redraws all the clusters.\n */\nMarkerClusterer.prototype.redraw_ = function () {\n  this.createClusters_(0);\n};\n\n\n/**\n * Removes all clusters from the map. The markers are also removed from the map\n *  if <code>opt_hide</code> is set to <code>true</code>.\n *\n * @param {boolean} [opt_hide] Set to <code>true</code> to also remove the markers\n *  from the map.\n */\nMarkerClusterer.prototype.resetViewport_ = function (opt_hide) {\n  var i, marker;\n  // Remove all the clusters\n  for (i = 0; i < this.clusters_.length; i++) {\n    this.clusters_[i].remove();\n  }\n  this.clusters_ = [];\n\n  // Reset the markers to not be added and to be removed from the map.\n  for (i = 0; i < this.markers_.length; i++) {\n    marker = this.markers_[i];\n    marker.isAdded = false;\n    if (opt_hide) {\n      marker.setMap(null);\n    }\n  }\n};\n\n\n/**\n * Calculates the distance between two latlng locations in km.\n *\n * @param {google.maps.LatLng} p1 The first lat lng point.\n * @param {google.maps.LatLng} p2 The second lat lng point.\n * @return {number} The distance between the two points in km.\n * @see http://www.movable-type.co.uk/scripts/latlong.html\n*/\nMarkerClusterer.prototype.distanceBetweenPoints_ = function (p1, p2) {\n  var R = 6371; // Radius of the Earth in km\n  var dLat = (p2.lat() - p1.lat()) * Math.PI / 180;\n  var dLon = (p2.lng() - p1.lng()) * Math.PI / 180;\n  var a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n    Math.cos(p1.lat() * Math.PI / 180) * Math.cos(p2.lat() * Math.PI / 180) *\n    Math.sin(dLon / 2) * Math.sin(dLon / 2);\n  var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n  var d = R * c;\n  return d;\n};\n\n\n/**\n * Determines if a marker is contained in a bounds.\n *\n * @param {google.maps.Marker} marker The marker to check.\n * @param {google.maps.LatLngBounds} bounds The bounds to check against.\n * @return {boolean} True if the marker is in the bounds.\n */\nMarkerClusterer.prototype.isMarkerInBounds_ = function (marker, bounds) {\n  return bounds.contains(marker.getPosition());\n};\n\n\n/**\n * Adds a marker to a cluster, or creates a new cluster.\n *\n * @param {google.maps.Marker} marker The marker to add.\n */\nMarkerClusterer.prototype.addToClosestCluster_ = function (marker) {\n  var i, d, cluster, center;\n  var distance = 40000; // Some large number\n  var clusterToAddTo = null;\n  for (i = 0; i < this.clusters_.length; i++) {\n    cluster = this.clusters_[i];\n    center = cluster.getCenter();\n    if (center) {\n      d = this.distanceBetweenPoints_(center, marker.getPosition());\n      if (d < distance) {\n        distance = d;\n        clusterToAddTo = cluster;\n      }\n    }\n  }\n\n  if (clusterToAddTo && clusterToAddTo.isMarkerInClusterBounds(marker)) {\n    clusterToAddTo.addMarker(marker);\n  } else {\n    cluster = new Cluster(this);\n    cluster.addMarker(marker);\n    this.clusters_.push(cluster);\n  }\n};\n\n\n/**\n * Creates the clusters. This is done in batches to avoid timeout errors\n *  in some browsers when there is a huge number of markers.\n *\n * @param {number} iFirst The index of the first marker in the batch of\n *  markers to be added to clusters.\n */\nMarkerClusterer.prototype.createClusters_ = function (iFirst) {\n  var i, marker;\n  var mapBounds;\n  var cMarkerClusterer = this;\n  if (!this.ready_) {\n    return;\n  }\n\n  // Cancel previous batch processing if we're working on the first batch:\n  if (iFirst === 0) {\n    /**\n     * This event is fired when the <code>MarkerClusterer</code> begins\n     *  clustering markers.\n     * @name MarkerClusterer#clusteringbegin\n     * @param {MarkerClusterer} mc The MarkerClusterer whose markers are being clustered.\n     * @event\n     */\n    google.maps.event.trigger(this, \"clusteringbegin\", this);\n\n    if (typeof this.timerRefStatic !== \"undefined\") {\n      clearTimeout(this.timerRefStatic);\n      delete this.timerRefStatic;\n    }\n  }\n\n  // Get our current map view bounds.\n  // Create a new bounds object so we don't affect the map.\n  //\n  // See Comments 9 & 11 on Issue 3651 relating to this workaround for a Google Maps bug:\n  if (this.getMap().getZoom() > 3) {\n    mapBounds = new google.maps.LatLngBounds(this.getMap().getBounds().getSouthWest(),\n      this.getMap().getBounds().getNorthEast());\n  } else {\n    mapBounds = new google.maps.LatLngBounds(new google.maps.LatLng(85.02070771743472, -178.48388434375), new google.maps.LatLng(-85.08136444384544, 178.00048865625));\n  }\n  var bounds = this.getExtendedBounds(mapBounds);\n\n  var iLast = Math.min(iFirst + this.batchSize_, this.markers_.length);\n\n  for (i = iFirst; i < iLast; i++) {\n    marker = this.markers_[i];\n    if (!marker.isAdded && this.isMarkerInBounds_(marker, bounds)) {\n      if (!this.ignoreHidden_ || (this.ignoreHidden_ && marker.getVisible())) {\n        this.addToClosestCluster_(marker);\n      }\n    }\n  }\n\n  if (iLast < this.markers_.length) {\n    this.timerRefStatic = setTimeout(function () {\n      cMarkerClusterer.createClusters_(iLast);\n    }, 0);\n  } else {\n    delete this.timerRefStatic;\n\n    /**\n     * This event is fired when the <code>MarkerClusterer</code> stops\n     *  clustering markers.\n     * @name MarkerClusterer#clusteringend\n     * @param {MarkerClusterer} mc The MarkerClusterer whose markers are being clustered.\n     * @event\n     */\n    google.maps.event.trigger(this, \"clusteringend\", this);\n  }\n};\n\n\n/**\n * Extends an object's prototype by another's.\n *\n * @param {Object} obj1 The object to be extended.\n * @param {Object} obj2 The object to extend with.\n * @return {Object} The new extended object.\n * @ignore\n */\nMarkerClusterer.prototype.extend = function (obj1, obj2) {\n  return (function (object) {\n    var property;\n    for (property in object.prototype) {\n      this.prototype[property] = object.prototype[property];\n    }\n    return this;\n  }).apply(obj1, [obj2]);\n};\n\n\n/**\n * The default function for determining the label text and style\n * for a cluster icon.\n *\n * @param {Array.<google.maps.Marker>} markers The array of markers represented by the cluster.\n * @param {number} numStyles The number of marker styles available.\n * @return {ClusterIconInfo} The information resource for the cluster.\n * @constant\n * @ignore\n */\nMarkerClusterer.CALCULATOR = function (markers, numStyles) {\n  var index = 0;\n  var title = \"\";\n  var count = markers.length.toString();\n\n  var dv = count;\n  while (dv !== 0) {\n    dv = parseInt(dv / 10, 10);\n    index++;\n  }\n\n  index = Math.min(index, numStyles);\n  return {\n    text: count,\n    index: index,\n    title: title\n  };\n};\n\n\n/**\n * The number of markers to process in one batch.\n *\n * @type {number}\n * @constant\n */\nMarkerClusterer.BATCH_SIZE = 2000;\n\n\n/**\n * The number of markers to process in one batch (IE only).\n *\n * @type {number}\n * @constant\n */\nMarkerClusterer.BATCH_SIZE_IE = 500;\n\n\n/**\n * The default root name for the marker cluster images.\n *\n * @type {string}\n * @constant\n */\nMarkerClusterer.IMAGE_PATH = \"../images/m\";\n\n\n/**\n * The default extension name for the marker cluster images.\n *\n * @type {string}\n * @constant\n */\nMarkerClusterer.IMAGE_EXTENSION = \"png\";\n\n\n/**\n * The default array of sizes for the marker cluster images.\n *\n * @type {Array.<number>}\n * @constant\n */\nMarkerClusterer.IMAGE_SIZES = [53, 56, 66, 78, 90];\n"]}